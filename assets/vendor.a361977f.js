function yr(){}function ai(e,t){for(const n in t)e[n]=t[n];return e}function ui(e){return e&&typeof e=="object"&&typeof e.then=="function"}function gr(e){return e()}function Jn(){return Object.create(null)}function it(e){e.forEach(gr)}function oi(e){return typeof e=="function"}function vu(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function si(e){return Object.keys(e).length===0}function yu(e,t,n,r){if(e){const i=mr(e,t,n,r);return e[0](i)}}function mr(e,t,n,r){return e[1]&&r?ai(n.ctx.slice(),e[1](r(t))):n.ctx}function gu(e,t,n,r){if(e[2]&&r){const i=e[2](r(n));if(t.dirty===void 0)return i;if(typeof i=="object"){const u=[],o=Math.max(t.dirty.length,i.length);for(let s=0;s<o;s+=1)u[s]=t.dirty[s]|i[s];return u}return t.dirty|i}return t.dirty}function mu(e,t,n,r,i,u){if(i){const o=mr(t,n,r,u);e.p(o,i)}}function _u(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let r=0;r<n;r++)t[r]=-1;return t}return-1}function bu(e,t){e.appendChild(t)}function wu(e,t,n){e.insertBefore(t,n||null)}function ci(e){e.parentNode.removeChild(e)}function Eu(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function xu(e){return document.createElement(e)}function _r(e){return document.createTextNode(e)}function ku(){return _r(" ")}function Au(){return _r("")}function Su(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function Tu(e){return function(t){return t.preventDefault(),e.call(this,t)}}function Cu(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function li(e){return Array.from(e.childNodes)}function Ru(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function Ku(e,t){e.value=t==null?"":t}function Iu(e,t,n){e.classList[n?"add":"remove"](t)}let Xe;function he(e){Xe=e}function fi(){if(!Xe)throw new Error("Function called outside component initialization");return Xe}const ze=[],Zn=[],wt=[],er=[],hi=Promise.resolve();let Jt=!1;function di(){Jt||(Jt=!0,hi.then(Tn))}function Zt(e){wt.push(e)}const zt=new Set;let vt=0;function Tn(){const e=Xe;do{for(;vt<ze.length;){const t=ze[vt];vt++,he(t),pi(t.$$)}for(he(null),ze.length=0,vt=0;Zn.length;)Zn.pop()();for(let t=0;t<wt.length;t+=1){const n=wt[t];zt.has(n)||(zt.add(n),n())}wt.length=0}while(ze.length);for(;er.length;)er.pop()();Jt=!1,zt.clear(),he(e)}function pi(e){if(e.fragment!==null){e.update(),it(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Zt)}}const Et=new Set;let Se;function vi(){Se={r:0,c:[],p:Se}}function yi(){Se.r||it(Se.c),Se=Se.p}function br(e,t){e&&e.i&&(Et.delete(e),e.i(t))}function gi(e,t,n,r){if(e&&e.o){if(Et.has(e))return;Et.add(e),Se.c.push(()=>{Et.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}function Pu(e,t){const n=t.token={};function r(i,u,o,s){if(t.token!==n)return;t.resolved=s;let f=t.ctx;o!==void 0&&(f=f.slice(),f[o]=s);const y=i&&(t.current=i)(f);let m=!1;t.block&&(t.blocks?t.blocks.forEach((_,w)=>{w!==u&&_&&(vi(),gi(_,1,1,()=>{t.blocks[w]===_&&(t.blocks[w]=null)}),yi())}):t.block.d(1),y.c(),br(y,1),y.m(t.mount(),t.anchor),m=!0),t.block=y,t.blocks&&(t.blocks[u]=y),m&&Tn()}if(ui(e)){const i=fi();if(e.then(u=>{he(i),r(t.then,1,t.value,u),he(null)},u=>{if(he(i),r(t.catch,2,t.error,u),he(null),!t.hasCatch)throw u}),t.current!==t.pending)return r(t.pending,0),!0}else{if(t.current!==t.then)return r(t.then,1,t.value,e),!0;t.resolved=e}}function Du(e,t,n){const r=t.slice(),{resolved:i}=e;e.current===e.then&&(r[e.value]=i),e.current===e.catch&&(r[e.error]=i),e.block.p(r,n)}function Ou(e){e&&e.c()}function mi(e,t,n,r){const{fragment:i,on_mount:u,on_destroy:o,after_update:s}=e.$$;i&&i.m(t,n),r||Zt(()=>{const f=u.map(gr).filter(oi);o?o.push(...f):it(f),e.$$.on_mount=[]}),s.forEach(Zt)}function _i(e,t){const n=e.$$;n.fragment!==null&&(it(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function bi(e,t){e.$$.dirty[0]===-1&&(ze.push(e),di(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Bu(e,t,n,r,i,u,o,s=[-1]){const f=Xe;he(e);const y=e.$$={fragment:null,ctx:null,props:u,update:yr,not_equal:i,bound:Jn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(f?f.$$.context:[])),callbacks:Jn(),dirty:s,skip_bound:!1,root:t.target||f.$$.root};o&&o(y.root);let m=!1;if(y.ctx=n?n(e,t.props||{},(_,w,...T)=>{const E=T.length?T[0]:w;return y.ctx&&i(y.ctx[_],y.ctx[_]=E)&&(!y.skip_bound&&y.bound[_]&&y.bound[_](E),m&&bi(e,_)),w}):[],y.update(),m=!0,it(y.before_update),y.fragment=r?r(y.ctx):!1,t.target){if(t.hydrate){const _=li(t.target);y.fragment&&y.fragment.l(_),_.forEach(ci)}else y.fragment&&y.fragment.c();t.intro&&br(e.$$.fragment),mi(e,t.target,t.anchor,t.customElement),Tn()}he(f)}class Mu{$destroy(){_i(this,1),this.$destroy=yr}$on(t,n){const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(t){this.$$set&&!si(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var en=Array.isArray||function(e){return Object.prototype.toString.call(e)=="[object Array]"},at=kr,wi=Cn,Ei=Si,xi=wr,ki=xr,Ai=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^()])+)\\))?|\\(((?:\\\\.|[^()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function Cn(e){for(var t=[],n=0,r=0,i="",u;(u=Ai.exec(e))!=null;){var o=u[0],s=u[1],f=u.index;if(i+=e.slice(r,f),r=f+o.length,s){i+=s[1];continue}i&&(t.push(i),i="");var y=u[2],m=u[3],_=u[4],w=u[5],T=u[6],E=u[7],k=T==="+"||T==="*",S=T==="?"||T==="*",v=y||"/",c=_||w||(E?".*":"[^"+v+"]+?");t.push({name:m||n++,prefix:y||"",delimiter:v,optional:S,repeat:k,pattern:Ti(c)})}return r<e.length&&(i+=e.substr(r)),i&&t.push(i),t}function Si(e){return wr(Cn(e))}function wr(e){for(var t=new Array(e.length),n=0;n<e.length;n++)typeof e[n]=="object"&&(t[n]=new RegExp("^"+e[n].pattern+"$"));return function(r){for(var i="",u=r||{},o=0;o<e.length;o++){var s=e[o];if(typeof s=="string"){i+=s;continue}var f=u[s.name],y;if(f==null){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to be defined')}if(en(f)){if(!s.repeat)throw new TypeError('Expected "'+s.name+'" to not repeat, but received "'+f+'"');if(f.length===0){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to not be empty')}for(var m=0;m<f.length;m++){if(y=encodeURIComponent(f[m]),!t[o].test(y))throw new TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'", but received "'+y+'"');i+=(m===0?s.prefix:s.delimiter)+y}continue}if(y=encodeURIComponent(f),!t[o].test(y))throw new TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but received "'+y+'"');i+=s.prefix+y}return i}}function tr(e){return e.replace(/([.+*?=^!:${}()[\]|\/])/g,"\\$1")}function Ti(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function Rn(e,t){return e.keys=t,e}function Er(e){return e.sensitive?"":"i"}function Ci(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,pattern:null});return Rn(e,t)}function Ri(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(kr(e[i],t,n).source);var u=new RegExp("(?:"+r.join("|")+")",Er(n));return Rn(u,t)}function Ki(e,t,n){for(var r=Cn(e),i=xr(r,n),u=0;u<r.length;u++)typeof r[u]!="string"&&t.push(r[u]);return Rn(i,t)}function xr(e,t){t=t||{};for(var n=t.strict,r=t.end!==!1,i="",u=e[e.length-1],o=typeof u=="string"&&/\/$/.test(u),s=0;s<e.length;s++){var f=e[s];if(typeof f=="string")i+=tr(f);else{var y=tr(f.prefix),m=f.pattern;f.repeat&&(m+="(?:"+y+m+")*"),f.optional?y?m="(?:"+y+"("+m+"))?":m="("+m+")?":m=y+"("+m+")",i+=m}}return n||(i=(o?i.slice(0,-2):i)+"(?:\\/(?=$))?"),r?i+="$":i+=n&&o?"":"(?=\\/|$)",new RegExp("^"+i,Er(t))}function kr(e,t,n){return t=t||[],en(t)?n||(n={}):(n=t,t=[]),e instanceof RegExp?Ci(e,t):en(e)?Ri(e,t,n):Ki(e,t,n)}at.parse=wi;at.compile=Ei;at.tokensToFunction=xi;at.tokensToRegExp=ki;var Le=typeof document!="undefined",re=typeof window!="undefined",Lt=typeof history!="undefined",Ii=typeof process!="undefined",tn=Le&&document.ontouchstart?"touchstart":"click",pe=re&&!!(window.history.location||window.location);function U(){this.callbacks=[],this.exits=[],this.current="",this.len=0,this._decodeURLComponents=!0,this._base="",this._strict=!1,this._running=!1,this._hashbang=!1,this.clickHandler=this.clickHandler.bind(this),this._onpopstate=this._onpopstate.bind(this)}U.prototype.configure=function(e){var t=e||{};this._window=t.window||re&&window,this._decodeURLComponents=t.decodeURLComponents!==!1,this._popstate=t.popstate!==!1&&re,this._click=t.click!==!1&&Le,this._hashbang=!!t.hashbang;var n=this._window;this._popstate?n.addEventListener("popstate",this._onpopstate,!1):re&&n.removeEventListener("popstate",this._onpopstate,!1),this._click?n.document.addEventListener(tn,this.clickHandler,!1):Le&&n.document.removeEventListener(tn,this.clickHandler,!1),this._hashbang&&re&&!Lt?n.addEventListener("hashchange",this._onpopstate,!1):re&&n.removeEventListener("hashchange",this._onpopstate,!1)};U.prototype.base=function(e){if(arguments.length===0)return this._base;this._base=e};U.prototype._getBase=function(){var e=this._base;if(e)return e;var t=re&&this._window&&this._window.location;return re&&this._hashbang&&t&&t.protocol==="file:"&&(e=t.pathname),e};U.prototype.strict=function(e){if(arguments.length===0)return this._strict;this._strict=e};U.prototype.start=function(e){var t=e||{};if(this.configure(t),t.dispatch!==!1){this._running=!0;var n;if(pe){var r=this._window,i=r.location;this._hashbang&&~i.hash.indexOf("#!")?n=i.hash.substr(2)+i.search:this._hashbang?n=i.search+i.hash:n=i.pathname+i.search+i.hash}this.replace(n,null,!0,t.dispatch)}};U.prototype.stop=function(){if(!!this._running){this.current="",this.len=0,this._running=!1;var e=this._window;this._click&&e.document.removeEventListener(tn,this.clickHandler,!1),re&&e.removeEventListener("popstate",this._onpopstate,!1),re&&e.removeEventListener("hashchange",this._onpopstate,!1)}};U.prototype.show=function(e,t,n,r){var i=new ut(e,t,this),u=this.prevContext;return this.prevContext=i,this.current=i.path,n!==!1&&this.dispatch(i,u),i.handled!==!1&&r!==!1&&i.pushState(),i};U.prototype.back=function(e,t){var n=this;if(this.len>0){var r=this._window;Lt&&r.history.back(),this.len--}else setTimeout(e?function(){n.show(e,t)}:function(){n.show(n._getBase(),t)})};U.prototype.redirect=function(e,t){var n=this;typeof e=="string"&&typeof t=="string"&&Nt.call(this,e,function(r){setTimeout(function(){n.replace(t)},0)}),typeof e=="string"&&typeof t=="undefined"&&setTimeout(function(){n.replace(e)},0)};U.prototype.replace=function(e,t,n,r){var i=new ut(e,t,this),u=this.prevContext;return this.prevContext=i,this.current=i.path,i.init=n,i.save(),r!==!1&&this.dispatch(i,u),i};U.prototype.dispatch=function(e,t){var n=0,r=0,i=this;function u(){var s=i.exits[r++];if(!s)return o();s(t,u)}function o(){var s=i.callbacks[n++];if(e.path!==i.current){e.handled=!1;return}if(!s)return Pi.call(i,e);s(e,o)}t?u():o()};U.prototype.exit=function(e,t){if(typeof e=="function")return this.exit("*",e);for(var n=new ot(e,null,this),r=1;r<arguments.length;++r)this.exits.push(n.middleware(arguments[r]))};U.prototype.clickHandler=function(e){if(this._which(e)===1&&!(e.metaKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented){var t=e.target,n=e.path||(e.composedPath?e.composedPath():null);if(n){for(var r=0;r<n.length;r++)if(!!n[r].nodeName&&n[r].nodeName.toUpperCase()==="A"&&!!n[r].href){t=n[r];break}}for(;t&&t.nodeName.toUpperCase()!=="A";)t=t.parentNode;if(!(!t||t.nodeName.toUpperCase()!=="A")){var i=typeof t.href=="object"&&t.href.constructor.name==="SVGAnimatedString";if(!(t.hasAttribute("download")||t.getAttribute("rel")==="external")){var u=t.getAttribute("href");if(!(!this._hashbang&&this._samePath(t)&&(t.hash||u==="#"))&&!(u&&u.indexOf("mailto:")>-1)&&!(i?t.target.baseVal:t.target)&&!(!i&&!this.sameOrigin(t.href))){var o=i?t.href.baseVal:t.pathname+t.search+(t.hash||"");o=o[0]!=="/"?"/"+o:o,Ii&&o.match(/^\/[a-zA-Z]:\//)&&(o=o.replace(/^\/[a-zA-Z]:\//,"/"));var s=o,f=this._getBase();o.indexOf(f)===0&&(o=o.substr(f.length)),this._hashbang&&(o=o.replace("#!","")),!(f&&s===o&&(!pe||this._window.location.protocol!=="file:"))&&(e.preventDefault(),this.show(s))}}}}};U.prototype._onpopstate=function(){var e=!1;return re?(Le&&document.readyState==="complete"?e=!0:window.addEventListener("load",function(){setTimeout(function(){e=!0},0)}),function(n){if(!!e){var r=this;if(n.state){var i=n.state.path;r.replace(i,n.state)}else if(pe){var u=r._window.location;r.show(u.pathname+u.search+u.hash,void 0,void 0,!1)}}}):function(){}}();U.prototype._which=function(e){return e=e||re&&this._window.event,e.which==null?e.button:e.which};U.prototype._toURL=function(e){var t=this._window;if(typeof URL=="function"&&pe)return new URL(e,t.location.toString());if(Le){var n=t.document.createElement("a");return n.href=e,n}};U.prototype.sameOrigin=function(e){if(!e||!pe)return!1;var t=this._toURL(e),n=this._window,r=n.location;return r.protocol===t.protocol&&r.hostname===t.hostname&&(r.port===t.port||r.port===""&&(t.port==80||t.port==443))};U.prototype._samePath=function(e){if(!pe)return!1;var t=this._window,n=t.location;return e.pathname===n.pathname&&e.search===n.search};U.prototype._decodeURLEncodedURIComponent=function(e){return typeof e!="string"?e:this._decodeURLComponents?decodeURIComponent(e.replace(/\+/g," ")):e};function Ar(){var e=new U;function t(){return Nt.apply(e,arguments)}return t.callbacks=e.callbacks,t.exits=e.exits,t.base=e.base.bind(e),t.strict=e.strict.bind(e),t.start=e.start.bind(e),t.stop=e.stop.bind(e),t.show=e.show.bind(e),t.back=e.back.bind(e),t.redirect=e.redirect.bind(e),t.replace=e.replace.bind(e),t.dispatch=e.dispatch.bind(e),t.exit=e.exit.bind(e),t.configure=e.configure.bind(e),t.sameOrigin=e.sameOrigin.bind(e),t.clickHandler=e.clickHandler.bind(e),t.create=Ar,Object.defineProperty(t,"len",{get:function(){return e.len},set:function(n){e.len=n}}),Object.defineProperty(t,"current",{get:function(){return e.current},set:function(n){e.current=n}}),t.Context=ut,t.Route=ot,t}function Nt(e,t){if(typeof e=="function")return Nt.call(this,"*",e);if(typeof t=="function")for(var n=new ot(e,null,this),r=1;r<arguments.length;++r)this.callbacks.push(n.middleware(arguments[r]));else typeof e=="string"?this[typeof t=="string"?"redirect":"show"](e,t):this.start(e)}function Pi(e){if(!e.handled){var t,n=this,r=n._window;n._hashbang?t=pe&&this._getBase()+r.location.hash.replace("#!",""):t=pe&&r.location.pathname+r.location.search,t!==e.canonicalPath&&(n.stop(),e.handled=!1,pe&&(r.location.href=e.canonicalPath))}}function Di(e){return e.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function ut(e,t,n){var r=this.page=n||Nt,i=r._window,u=r._hashbang,o=r._getBase();e[0]==="/"&&e.indexOf(o)!==0&&(e=o+(u?"#!":"")+e);var s=e.indexOf("?");this.canonicalPath=e;var f=new RegExp("^"+Di(o));if(this.path=e.replace(f,"")||"/",u&&(this.path=this.path.replace("#!","")||"/"),this.title=Le&&i.document.title,this.state=t||{},this.state.path=e,this.querystring=~s?r._decodeURLEncodedURIComponent(e.slice(s+1)):"",this.pathname=r._decodeURLEncodedURIComponent(~s?e.slice(0,s):e),this.params={},this.hash="",!u){if(!~this.path.indexOf("#"))return;var y=this.path.split("#");this.path=this.pathname=y[0],this.hash=r._decodeURLEncodedURIComponent(y[1])||"",this.querystring=this.querystring.split("#")[0]}}ut.prototype.pushState=function(){var e=this.page,t=e._window,n=e._hashbang;e.len++,Lt&&t.history.pushState(this.state,this.title,n&&this.path!=="/"?"#!"+this.path:this.canonicalPath)};ut.prototype.save=function(){var e=this.page;Lt&&e._window.history.replaceState(this.state,this.title,e._hashbang&&this.path!=="/"?"#!"+this.path:this.canonicalPath)};function ot(e,t,n){var r=this.page=n||Kn,i=t||{};i.strict=i.strict||r._strict,this.path=e==="*"?"(.*)":e,this.method="GET",this.regexp=at(this.path,this.keys=[],i)}ot.prototype.middleware=function(e){var t=this;return function(n,r){if(t.match(n.path,n.params))return n.routePath=t.path,e(n,r);r()}};ot.prototype.match=function(e,t){var n=this.keys,r=e.indexOf("?"),i=~r?e.slice(0,r):e,u=this.regexp.exec(decodeURIComponent(i));if(!u)return!1;delete t[0];for(var o=1,s=u.length;o<s;++o){var f=n[o-1],y=this.page._decodeURLEncodedURIComponent(u[o]);(y!==void 0||!hasOwnProperty.call(t,f.name))&&(t[f.name]=y)}return!0};var Kn=Ar(),Oi=Kn,Bi=Kn;Oi.default=Bi;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var F=function(){return F=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var u in n)Object.prototype.hasOwnProperty.call(n,u)&&(t[u]=n[u])}return t},F.apply(this,arguments)};function nn(e,t,n){if(n||arguments.length===2)for(var r=0,i=t.length,u;r<i;r++)(u||!(r in t))&&(u||(u=Array.prototype.slice.call(t,0,r)),u[r]=t[r]);return e.concat(u||Array.prototype.slice.call(t))}var $=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:global,H=Object.keys,q=Array.isArray;typeof Promise!="undefined"&&!$.Promise&&($.Promise=Promise);function Z(e,t){return typeof t!="object"||H(t).forEach(function(n){e[n]=t[n]}),e}var Qe=Object.getPrototypeOf,Mi={}.hasOwnProperty;function ie(e,t){return Mi.call(e,t)}function Ne(e,t){typeof t=="function"&&(t=t(Qe(e))),(typeof Reflect=="undefined"?H:Reflect.ownKeys)(t).forEach(function(n){ye(e,n,t[n])})}var Sr=Object.defineProperty;function ye(e,t,n,r){Sr(e,t,Z(n&&ie(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function $e(e){return{from:function(t){return e.prototype=Object.create(t.prototype),ye(e.prototype,"constructor",e),{extend:Ne.bind(null,e.prototype)}}}}var Fi=Object.getOwnPropertyDescriptor;function In(e,t){var n=Fi(e,t),r;return n||(r=Qe(e))&&In(r,t)}var Li=[].slice;function $t(e,t,n){return Li.call(e,t,n)}function Tr(e,t){return t(e)}function Ve(e){if(!e)throw new Error("Assertion Failed")}function Cr(e){$.setImmediate?setImmediate(e):setTimeout(e,0)}function Rr(e,t){return e.reduce(function(n,r,i){var u=t(r,i);return u&&(n[u[0]]=u[1]),n},{})}function Ni(e,t,n){try{e.apply(null,n)}catch(r){t&&t(r)}}function ve(e,t){if(ie(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var u=ve(e,t[r]);n.push(u)}return n}var o=t.indexOf(".");if(o!==-1){var s=e[t.substr(0,o)];return s===void 0?void 0:ve(s,t.substr(o+1))}}function ue(e,t,n){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Ve(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)ue(e,t[r],n[r])}else{var u=t.indexOf(".");if(u!==-1){var o=t.substr(0,u),s=t.substr(u+1);if(s==="")n===void 0?q(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n;else{var f=e[o];f||(f=e[o]={}),ue(f,s,n)}}else n===void 0?q(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function $i(e,t){typeof t=="string"?ue(e,t,void 0):"length"in t&&[].map.call(t,function(n){ue(e,n,void 0)})}function Kr(e){var t={};for(var n in e)ie(e,n)&&(t[n]=e[n]);return t}var ji=[].concat;function Ir(e){return ji.apply([],e)}var Pr="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ir([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return $[e]}),Hi=Pr.map(function(e){return $[e]});Rr(Pr,function(e){return[e,!0]});var be=null;function st(e){be=typeof WeakMap!="undefined"&&new WeakMap;var t=rn(e);return be=null,t}function rn(e){if(!e||typeof e!="object")return e;var t=be&&be.get(e);if(t)return t;if(q(e)){t=[],be&&be.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(rn(e[n]))}else if(Hi.indexOf(e.constructor)>=0)t=e;else{var i=Qe(e);t=i===Object.prototype?{}:Object.create(i),be&&be.set(e,t);for(var u in e)ie(e,u)&&(t[u]=rn(e[u]))}return t}var Ui={}.toString;function an(e){return Ui.call(e).slice(8,-1)}var un=typeof Symbol!="undefined"?Symbol.iterator:"@@iterator",zi=typeof un=="symbol"?function(e){var t;return e!=null&&(t=e[un])&&t.apply(e)}:function(){return null},Me={};function fe(e){var t,n,r,i;if(arguments.length===1){if(q(e))return e.slice();if(this===Me&&typeof e=="string")return[e];if(i=zi(e)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Pn=typeof Symbol!="undefined"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},se=typeof location!="undefined"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Dr(e,t){se=e,Or=t}var Or=function(){return!0},Vi=!new Error("").stack;function Pe(){if(Vi)try{throw Pe.arguments,new Error}catch(e){return e}return new Error}function on(e,t){var n=e.stack;return n?(t=t||0,n.indexOf(e.name)===0&&(t+=(e.name+e.message).split(`
`).length),n.split(`
`).slice(t).filter(Or).map(function(r){return`
`+r}).join("")):""}var Wi=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],Br=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Dn=Wi.concat(Br),Gi={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function je(e,t){this._e=Pe(),this.name=e,this.message=t}$e(je).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+on(this._e,2))}},toString:function(){return this.name+": "+this.message}});function Mr(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function Rt(e,t,n,r){this._e=Pe(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Mr(e,t)}$e(Rt).from(je);function Ge(e,t){this._e=Pe(),this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=Mr(e,t)}$e(Ge).from(je);var On=Dn.reduce(function(e,t){return e[t]=t+"Error",e},{}),Yi=je,B=Dn.reduce(function(e,t){var n=t+"Error";function r(i,u){this._e=Pe(),this.name=n,i?typeof i=="string"?(this.message=""+i+(u?`
 `+u:""),this.inner=u||null):typeof i=="object"&&(this.message=i.name+" "+i.message,this.inner=i):(this.message=Gi[t]||n,this.inner=null)}return $e(r).from(Yi),e[t]=r,e},{});B.Syntax=SyntaxError;B.Type=TypeError;B.Range=RangeError;var nr=Br.reduce(function(e,t){return e[t+"Error"]=B[t],e},{});function qi(e,t){if(!e||e instanceof je||e instanceof TypeError||e instanceof SyntaxError||!e.name||!nr[e.name])return e;var n=new nr[e.name](t||e.message,e);return"stack"in e&&ye(n,"stack",{get:function(){return this.inner.stack}}),n}var jt=Dn.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=B[t]),e},{});jt.ModifyError=Rt;jt.DexieError=je;jt.BulkError=Ge;function N(){}function ct(e){return e}function Xi(e,t){return e==null||e===ct?t:function(n){return t(e(n))}}function Ke(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Qi(e,t){return e===N?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var u=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Ke(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Ke(i,this.onerror):i),u!==void 0?u:n}}function Ji(e,t){return e===N?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Ke(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Ke(r,this.onerror):r)}}function Zi(e,t){return e===N?t:function(n){var r=e.apply(this,arguments);Z(n,r);var i=this.onsuccess,u=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Ke(i,this.onsuccess):i),u&&(this.onerror=this.onerror?Ke(u,this.onerror):u),r===void 0?o===void 0?void 0:o:Z(r,o)}}function ea(e,t){return e===N?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function Bn(e,t){return e===N?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,u=new Array(i);i--;)u[i]=arguments[i];return n.then(function(){return t.apply(r,u)})}return t.apply(this,arguments)}}var Je={},ta=100,na=20,Fr=100,Mn=typeof Promise=="undefined"?[]:function(){var e=Promise.resolve();if(typeof crypto=="undefined"||!crypto.subtle)return[e,Qe(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Qe(t),e]}(),sn=Mn[0],Kt=Mn[1],cn=Mn[2],Lr=Kt&&Kt.then,xt=sn&&sn.constructor,Fn=!!cn,ln=!1,ra=cn?function(){cn.then(yt)}:$.setImmediate?setImmediate.bind(null,yt):$.MutationObserver?function(){var e=document.createElement("div");new MutationObserver(function(){yt(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(yt,0)},Ze=function(e,t){We.push([e,t]),It&&(ra(),It=!1)},fn=!0,It=!0,Ce=[],kt=[],hn=null,dn=ct,Fe={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ar,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(function(e){try{ar(e[0],e[1])}catch{}})}},O=Fe,We=[],Re=0,At=[];function I(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=N,this._lib=!1;var t=this._PSD=O;if(se&&(this._stackHolder=Pe(),this._prev=null,this._numPrev=0),typeof e!="function"){if(e!==Je)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&vn(this,this._value);return}this._state=null,this._value=null,++t.ref,$r(this,e)}var pn={get:function(){var e=O,t=Pt;function n(r,i){var u=this,o=!e.global&&(e!==O||t!==Pt),s=o&&!ge(),f=new I(function(y,m){Ln(u,new Nr(Ot(r,e,o,s),Ot(i,e,o,s),y,m,e))});return se&&Ur(f,this),f}return n.prototype=Je,n},set:function(e){ye(this,"then",e&&e.prototype===Je?pn:{get:function(){return e},set:pn.set})}};Ne(I.prototype,{then:pn,_then:function(e,t){Ln(this,new Nr(null,null,e,t,O))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],n=arguments[1];return typeof t=="function"?this.then(null,function(r){return r instanceof t?n(r):St(r)}):this.then(null,function(r){return r&&r.name===t?n(r):St(r)})},finally:function(e){return this.then(function(t){return e(),t},function(t){return e(),St(t)})},stack:{get:function(){if(this._stack)return this._stack;try{ln=!0;var e=Hr(this,[],na),t=e.join(`
From previous: `);return this._state!==null&&(this._stack=t),t}finally{ln=!1}}},timeout:function(e,t){var n=this;return e<1/0?new I(function(r,i){var u=setTimeout(function(){return i(new B.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,u))}):this}});typeof Symbol!="undefined"&&Symbol.toStringTag&&ye(I.prototype,Symbol.toStringTag,"Dexie.Promise");Fe.env=zr();function Nr(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}Ne(I,{all:function(){var e=fe.apply(null,arguments).map(Dt);return new I(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,u){return I.resolve(i).then(function(o){e[u]=o,--r||t(e)},n)})})},resolve:function(e){if(e instanceof I)return e;if(e&&typeof e.then=="function")return new I(function(n,r){e.then(n,r)});var t=new I(Je,!0,e);return Ur(t,hn),t},reject:St,race:function(){var e=fe.apply(null,arguments).map(Dt);return new I(function(t,n){e.map(function(r){return I.resolve(r).then(t,n)})})},PSD:{get:function(){return O},set:function(e){return O=e}},totalEchoes:{get:function(){return Pt}},newPSD:Ee,usePSD:Ue,scheduler:{get:function(){return Ze},set:function(e){Ze=e}},rejectionMapper:{get:function(){return dn},set:function(e){dn=e}},follow:function(e,t){return new I(function(n,r){return Ee(function(i,u){var o=O;o.unhandleds=[],o.onunhandled=u,o.finalize=Ke(function(){var s=this;aa(function(){s.unhandleds.length===0?i():u(s.unhandleds[0])})},o.finalize),e()},t,n,r)})}});xt&&(xt.allSettled&&ye(I,"allSettled",function(){var e=fe.apply(null,arguments).map(Dt);return new I(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,u){return I.resolve(i).then(function(o){return r[u]={status:"fulfilled",value:o}},function(o){return r[u]={status:"rejected",reason:o}}).then(function(){return--n||t(r)})})})}),xt.any&&typeof AggregateError!="undefined"&&ye(I,"any",function(){var e=fe.apply(null,arguments).map(Dt);return new I(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(u,o){return I.resolve(u).then(function(s){return t(s)},function(s){i[o]=s,--r||n(new AggregateError(i))})})})}));function $r(e,t){try{t(function(n){if(e._state===null){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&lt();n&&typeof n.then=="function"?$r(e,function(i,u){n instanceof I?n._then(i,u):n.then(i,u)}):(e._state=!0,e._value=n,jr(e)),r&&ft()}},vn.bind(null,e))}catch(n){vn(e,n)}}function vn(e,t){if(kt.push(t),e._state===null){var n=e._lib&&lt();t=dn(t),e._state=!1,e._value=t,se&&t!==null&&typeof t=="object"&&!t._promise&&Ni(function(){var r=In(t,"stack");t._promise=e,ye(t,"stack",{get:function(){return ln?r&&(r.get?r.get.apply(t):r.value):e.stack}})}),ua(e),jr(e),n&&ft()}}function jr(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ln(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),Re===0&&(++Re,Ze(function(){--Re===0&&Nn()},[]))}function Ln(e,t){if(e._state===null){e._listeners.push(t);return}var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Re,Ze(ia,[n,e,t])}function ia(e,t,n){try{hn=t;var r,i=t._value;t._state?r=e(i):(kt.length&&(kt=[]),r=e(i),kt.indexOf(i)===-1&&oa(t)),n.resolve(r)}catch(u){n.reject(u)}finally{hn=null,--Re===0&&Nn(),--n.psd.ref||n.psd.finalize()}}function Hr(e,t,n){if(t.length===n)return t;var r="";if(e._state===!1){var i=e._value,u,o;i!=null?(u=i.name||"Error",o=i.message||i,r=on(i,0)):(u=i,o=""),t.push(u+(o?": "+o:"")+r)}return se&&(r=on(e._stackHolder,2),r&&t.indexOf(r)===-1&&t.push(r),e._prev&&Hr(e._prev,t,n)),t}function Ur(e,t){var n=t?t._numPrev+1:0;n<ta&&(e._prev=t,e._numPrev=n)}function yt(){lt()&&ft()}function lt(){var e=fn;return fn=!1,It=!1,e}function ft(){var e,t,n;do for(;We.length>0;)for(e=We,We=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(We.length>0);fn=!0,It=!0}function Nn(){var e=Ce;Ce=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=At.slice(0),n=t.length;n;)t[--n]()}function aa(e){function t(){e(),At.splice(At.indexOf(t),1)}At.push(t),++Re,Ze(function(){--Re===0&&Nn()},[])}function ua(e){Ce.some(function(t){return t._value===e._value})||Ce.push(e)}function oa(e){for(var t=Ce.length;t;)if(Ce[--t]._value===e._value){Ce.splice(t,1);return}}function St(e){return new I(Je,!1,e)}function j(e,t){var n=O;return function(){var r=lt(),i=O;try{return xe(n,!0),e.apply(this,arguments)}catch(u){t&&t(u)}finally{xe(i,!1),r&&ft()}}}var Y={awaits:0,echoes:0,id:0},sa=0,Tt=[],Vt=0,Pt=0,ca=0;function Ee(e,t,n,r){var i=O,u=Object.create(i);u.parent=i,u.ref=0,u.global=!1,u.id=++ca;var o=Fe.env;u.env=Fn?{Promise:I,PromiseProp:{value:I,configurable:!0,writable:!0},all:I.all,race:I.race,allSettled:I.allSettled,any:I.any,resolve:I.resolve,reject:I.reject,nthen:rr(o.nthen,u),gthen:rr(o.gthen,u)}:{},t&&Z(u,t),++i.ref,u.finalize=function(){--this.parent.ref||this.parent.finalize()};var s=Ue(u,e,n,r);return u.ref===0&&u.finalize(),s}function He(){return Y.id||(Y.id=++sa),++Y.awaits,Y.echoes+=Fr,Y.id}function ge(){return Y.awaits?(--Y.awaits===0&&(Y.id=0),Y.echoes=Y.awaits*Fr,!0):!1}(""+Lr).indexOf("[native code]")===-1&&(He=ge=N);function Dt(e){return Y.echoes&&e&&e.constructor===xt?(He(),e.then(function(t){return ge(),t},function(t){return ge(),V(t)})):e}function la(e){++Pt,(!Y.echoes||--Y.echoes===0)&&(Y.echoes=Y.id=0),Tt.push(O),xe(e,!0)}function fa(){var e=Tt[Tt.length-1];Tt.pop(),xe(e,!1)}function xe(e,t){var n=O;if((t?Y.echoes&&(!Vt++||e!==O):Vt&&(!--Vt||e!==O))&&Vr(t?la.bind(null,e):fa),e!==O&&(O=e,n===Fe&&(Fe.env=zr()),Fn)){var r=Fe.env.Promise,i=e.env;Kt.then=i.nthen,r.prototype.then=i.gthen,(n.global||e.global)&&(Object.defineProperty($,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function zr(){var e=$.Promise;return Fn?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor($,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:Kt.then,gthen:e.prototype.then}:{}}function Ue(e,t,n,r,i){var u=O;try{return xe(e,!0),t(n,r,i)}finally{xe(u,!1)}}function Vr(e){Lr.call(sn,e)}function Ot(e,t,n,r){return typeof e!="function"?e:function(){var i=O;n&&He(),xe(t,!0);try{return e.apply(this,arguments)}finally{xe(i,!1),r&&Vr(ge)}}}function rr(e,t){return function(n,r){return e.call(this,Ot(n,t),Ot(r,t))}}var ir="unhandledrejection";function ar(e,t){var n;try{n=t.onuncatched(e)}catch{}if(n!==!1)try{var r,i={promise:t,reason:e};if($.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(ir,!0,!0),Z(r,i)):$.CustomEvent&&(r=new CustomEvent(ir,{detail:i}),Z(r,i)),r&&$.dispatchEvent&&(dispatchEvent(r),!$.PromiseRejectionEvent&&$.onunhandledrejection))try{$.onunhandledrejection(r)}catch{}se&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch{}}var V=I.reject;function yn(e,t,n,r){if(!e.idbdb||!e._state.openComplete&&!O.letThrough&&!e._vip){if(e._state.openComplete)return V(new B.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return V(new B.DatabaseClosed);e.open().catch(N)}return e._state.dbReadyPromise.then(function(){return yn(e,t,n,r)})}else{var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(u){return u.name===On.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(function(){return yn(e,t,n,r)})):V(u)}return i._promise(t,function(u,o){return Ee(function(){return O.trans=i,r(u,o,i)})}).then(function(u){return i._completion.then(function(){return u})})}}var ur="3.2.1",Te=String.fromCharCode(65535),gn=-1/0,ce="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Wr="String expected.",Ye=[],Ht=typeof navigator!="undefined"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),ha=Ht,da=Ht,Gr=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)},Ut="__dbnames",Wt="readonly",Gt="readwrite";function Ie(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Yr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function gt(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=st(t),delete t[e]),t}:function(t){return t}}var pa=function(){function e(){}return e.prototype._trans=function(t,n,r){var i=this._tx||O.trans,u=this.name;function o(f,y,m){if(!m.schema[u])throw new B.NotFound("Table "+u+" not part of transaction");return n(m.idbtrans,m)}var s=lt();try{return i&&i.db===this.db?i===O.trans?i._promise(t,o,r):Ee(function(){return i._promise(t,o,r)},{trans:i,transless:O.transless||O}):yn(this.db,t,[this.name],o)}finally{s&&ft()}},e.prototype.get=function(t,n){var r=this;return t&&t.constructor===Object?this.where(t).first(n):this._trans("readonly",function(i){return r.core.get({trans:i,key:t}).then(function(u){return r.hook.reading.fire(u)})}).then(n)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(q(t))return new this.db.WhereClause(this,"["+t.join("+")+"]");var n=H(t);if(n.length===1)return this.where(n[0]).equals(t[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(m){return m.compound&&n.every(function(_){return m.keyPath.indexOf(_)>=0})&&m.keyPath.every(function(_){return n.indexOf(_)>=0})})[0];if(r&&this.db._maxKey!==Te)return this.where(r.name).equals(r.keyPath.map(function(m){return t[m]}));!r&&se&&console.warn("The query "+JSON.stringify(t)+" on "+this.name+" would benefit of a "+("compound index ["+n.join("+")+"]"));var i=this.schema.idxByName,u=this.db._deps.indexedDB;function o(m,_){try{return u.cmp(m,_)===0}catch{return!1}}var s=n.reduce(function(m,_){var w=m[0],T=m[1],E=i[_],k=t[_];return[w||E,w||!E?Ie(T,E&&E.multi?function(S){var v=ve(S,_);return q(v)&&v.some(function(c){return o(k,c)})}:function(S){return o(k,ve(S,_))}):T]},[null,null]),f=s[0],y=s[1];return f?this.where(f.name).equals(t[f.keyPath]).filter(y):r?this.filter(y):this.where(n).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,q(t)?"["+t.join("+")+"]":t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){this.schema.mappedClass=t;var n=function(r){if(!r)return r;var i=Object.create(t.prototype);for(var u in r)if(ie(r,u))try{i[u]=r[u]}catch{}return i};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),t},e.prototype.defineClass=function(){function t(n){Z(this,n)}return this.mapToClass(t)},e.prototype.add=function(t,n){var r=this,i=this.schema.primKey,u=i.auto,o=i.keyPath,s=t;return o&&u&&(s=gt(o)(t)),this._trans("readwrite",function(f){return r.core.mutate({trans:f,type:"add",keys:n!=null?[n]:null,values:[s]})}).then(function(f){return f.numFailures?I.reject(f.failures[0]):f.lastResult}).then(function(f){if(o)try{ue(t,o,f)}catch{}return f})},e.prototype.update=function(t,n){if(typeof t=="object"&&!q(t)){var r=ve(t,this.schema.primKey.keyPath);if(r===void 0)return V(new B.InvalidArgument("Given object does not contain its primary key"));try{typeof n!="function"?H(n).forEach(function(i){ue(t,i,n[i])}):n(t,{value:t,primKey:r})}catch{}return this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(t).modify(n)},e.prototype.put=function(t,n){var r=this,i=this.schema.primKey,u=i.auto,o=i.keyPath,s=t;return o&&u&&(s=gt(o)(t)),this._trans("readwrite",function(f){return r.core.mutate({trans:f,type:"put",values:[s],keys:n!=null?[n]:null})}).then(function(f){return f.numFailures?I.reject(f.failures[0]):f.lastResult}).then(function(f){if(o)try{ue(t,o,f)}catch{}return f})},e.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[t]})}).then(function(r){return r.numFailures?I.reject(r.failures[0]):void 0})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"deleteRange",range:Yr})}).then(function(n){return n.numFailures?I.reject(n.failures[0]):void 0})},e.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:t,trans:r}).then(function(i){return i.map(function(u){return n.hook.reading.fire(u)})})})},e.prototype.bulkAdd=function(t,n,r){var i=this,u=Array.isArray(n)?n:void 0;r=r||(u?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(s){var f=i.schema.primKey,y=f.auto,m=f.keyPath;if(m&&u)throw new B.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(u&&u.length!==t.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");var _=t.length,w=m&&y?t.map(gt(m)):t;return i.core.mutate({trans:s,type:"add",keys:u,values:w,wantResults:o}).then(function(T){var E=T.numFailures,k=T.results,S=T.lastResult,v=T.failures,c=o?k:S;if(E===0)return c;throw new Ge(i.name+".bulkAdd(): "+E+" of "+_+" operations failed",v)})})},e.prototype.bulkPut=function(t,n,r){var i=this,u=Array.isArray(n)?n:void 0;r=r||(u?void 0:n);var o=r?r.allKeys:void 0;return this._trans("readwrite",function(s){var f=i.schema.primKey,y=f.auto,m=f.keyPath;if(m&&u)throw new B.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(u&&u.length!==t.length)throw new B.InvalidArgument("Arguments objects and keys must have the same length");var _=t.length,w=m&&y?t.map(gt(m)):t;return i.core.mutate({trans:s,type:"put",keys:u,values:w,wantResults:o}).then(function(T){var E=T.numFailures,k=T.results,S=T.lastResult,v=T.failures,c=o?k:S;if(E===0)return c;throw new Ge(i.name+".bulkPut(): "+E+" of "+_+" operations failed",v)})})},e.prototype.bulkDelete=function(t){var n=this,r=t.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:t})}).then(function(i){var u=i.numFailures,o=i.lastResult,s=i.failures;if(u===0)return o;throw new Ge(n.name+".bulkDelete(): "+u+" of "+r+" operations failed",s)})},e}();function ht(e){var t={},n=function(s,f){if(f){for(var y=arguments.length,m=new Array(y-1);--y;)m[y-1]=arguments[y];return t[s].subscribe.apply(null,m),e}else if(typeof s=="string")return t[s]};n.addEventType=u;for(var r=1,i=arguments.length;r<i;++r)u(arguments[r]);return n;function u(s,f,y){if(typeof s=="object")return o(s);f||(f=ea),y||(y=N);var m={subscribers:[],fire:y,subscribe:function(_){m.subscribers.indexOf(_)===-1&&(m.subscribers.push(_),m.fire=f(m.fire,_))},unsubscribe:function(_){m.subscribers=m.subscribers.filter(function(w){return w!==_}),m.fire=m.subscribers.reduce(f,y)}};return t[s]=n[s]=m,m}function o(s){H(s).forEach(function(f){var y=s[f];if(q(y))u(f,s[f][0],s[f][1]);else if(y==="asap")var m=u(f,ct,function(){for(var w=arguments.length,T=new Array(w);w--;)T[w]=arguments[w];m.subscribers.forEach(function(E){Cr(function(){E.apply(null,T)})})});else throw new B.InvalidArgument("Invalid event config")})}}function dt(e,t){return $e(t).from({prototype:e}),t}function va(e){return dt(pa.prototype,function(n,r,i){this.db=e,this._tx=i,this.name=n,this.schema=r,this.hook=e._allTables[n]?e._allTables[n].hook:ht(null,{creating:[Qi,N],reading:[Xi,ct],updating:[Zi,N],deleting:[Ji,N]})})}function Oe(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Yt(e,t){e.filter=Ie(e.filter,t)}function qt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Ie(r(),t())}:t,e.justLimit=n&&!r}function ya(e,t){e.isMatch=Ie(e.isMatch,t)}function Ct(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new B.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function or(e,t,n){var r=Ct(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function mt(e,t,n,r){var i=e.replayFilter?Ie(e.filter,e.replayFilter()):e.filter;if(e.or){var u={},o=function(s,f,y){if(!i||i(f,y,function(w){return f.stop(w)},function(w){return f.fail(w)})){var m=f.primaryKey,_=""+m;_==="[object ArrayBuffer]"&&(_=""+new Uint8Array(m)),ie(u,_)||(u[_]=!0,t(s,f,y))}};return Promise.all([e.or._iterate(o,n),sr(or(e,r,n),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}else return sr(or(e,r,n),Ie(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function sr(e,t,n,r){var i=r?function(o,s,f){return n(r(o),s,f)}:n,u=j(i);return e.then(function(o){if(o)return o.start(function(){var s=function(){return o.continue()};(!t||t(o,function(f){return s=f},function(f){o.stop(f),s=N},function(f){o.fail(f),s=N}))&&u(o.value,o,function(f){return s=f}),s()})})}function J(e,t){try{var n=cr(e),r=cr(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return ma(lr(e),lr(t));case"Array":return ga(e,t)}}catch{}return NaN}function ga(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,u=0;u<i;++u){var o=J(e[u],t[u]);if(o!==0)return o}return n===r?0:n<r?-1:1}function ma(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,u=0;u<i;++u)if(e[u]!==t[u])return e[u]<t[u]?-1:1;return n===r?0:n<r?-1:1}function cr(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var n=an(e);return n==="ArrayBuffer"?"binary":n}function lr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var _a=function(){function e(){}return e.prototype._read=function(t,n){var r=this._ctx;return r.error?r.table._trans(null,V.bind(null,r.error)):r.table._trans("readonly",t).then(n)},e.prototype._write=function(t){var n=this._ctx;return n.error?n.table._trans(null,V.bind(null,n.error)):n.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var n=this._ctx;n.algorithm=Ie(n.algorithm,t)},e.prototype._iterate=function(t,n){return mt(this._ctx,t,n,this._ctx.table.core)},e.prototype.clone=function(t){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&Z(r,t),n._ctx=r,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var n=this._ctx;return this._read(function(r){return mt(n,t,r,n.table.core)})},e.prototype.count=function(t){var n=this;return this._read(function(r){var i=n._ctx,u=i.table.core;if(Oe(i,!0))return u.count({trans:r,query:{index:Ct(i,u.schema),range:i.range}}).then(function(s){return Math.min(s,i.limit)});var o=0;return mt(i,function(){return++o,!1},r,u).then(function(){return o})}).then(t)},e.prototype.sortBy=function(t,n){var r=t.split(".").reverse(),i=r[0],u=r.length-1;function o(y,m){return m?o(y[r[m]],m-1):y[i]}var s=this._ctx.dir==="next"?1:-1;function f(y,m){var _=o(y,u),w=o(m,u);return _<w?-s:_>w?s:0}return this.toArray(function(y){return y.sort(f)}).then(n)},e.prototype.toArray=function(t){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&Oe(i,!0)&&i.limit>0){var u=i.valueMapper,o=Ct(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:o,range:i.range}}).then(function(f){var y=f.result;return u?y.map(u):y})}else{var s=[];return mt(i,function(f){return s.push(f)},r,i.table.core).then(function(){return s})}},t)},e.prototype.offset=function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,Oe(n)?qt(n,function(){var r=t;return function(i,u){return r===0?!0:r===1?(--r,!1):(u(function(){i.advance(r),r=0}),!1)}}):qt(n,function(){var r=t;return function(){return--r<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),qt(this._ctx,function(){var n=t;return function(r,i,u){return--n<=0&&i(u),n>=0}},!0),this},e.prototype.until=function(t,n){return Yt(this._ctx,function(r,i,u){return t(r.value)?(i(u),n):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return Yt(this._ctx,function(n){return t(n.value)}),ya(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.key,i)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.primaryKey,i)})},e.prototype.keys=function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,u){r.push(u.key)}).then(function(){return r}).then(t)},e.prototype.primaryKeys=function(t){var n=this._ctx;if(n.dir==="next"&&Oe(n,!0)&&n.limit>0)return this._read(function(i){var u=Ct(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:u,range:n.range}})}).then(function(i){var u=i.result;return u}).then(t);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,u){r.push(u.primaryKey)}).then(function(){return r}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(n){return n[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return Yt(this._ctx,function(i){var u=i.primaryKey.toString(),o=ie(r,u);return r[u]=!0,!o}),this},e.prototype.modify=function(t){var n=this,r=this._ctx;return this._write(function(i){var u;if(typeof t=="function")u=t;else{var o=H(t),s=o.length;u=function(v){for(var c=!1,h=0;h<s;++h){var d=o[h],l=t[d];ve(v,d)!==l&&(ue(v,d,l),c=!0)}return c}}var f=r.table.core,y=f.schema.primaryKey,m=y.outbound,_=y.extractKey,w=n.db._options.modifyChunkSize||200,T=[],E=0,k=[],S=function(v,c){var h=c.failures,d=c.numFailures;E+=v-d;for(var l=0,g=H(h);l<g.length;l++){var b=g[l];T.push(h[b])}};return n.clone().primaryKeys().then(function(v){var c=function(h){var d=Math.min(w,v.length-h);return f.getMany({trans:i,keys:v.slice(h,h+d),cache:"immutable"}).then(function(l){for(var g=[],b=[],x=m?[]:null,C=[],A=0;A<d;++A){var K=l[A],R={value:st(K),primKey:v[h+A]};u.call(R,R.value,R)!==!1&&(R.value==null?C.push(v[h+A]):!m&&J(_(K),_(R.value))!==0?(C.push(v[h+A]),g.push(R.value)):(b.push(R.value),m&&x.push(v[h+A])))}var M=Oe(r)&&r.limit===1/0&&(typeof t!="function"||t===Xt)&&{index:r.index,range:r.range};return Promise.resolve(g.length>0&&f.mutate({trans:i,type:"add",values:g}).then(function(D){for(var P in D.failures)C.splice(parseInt(P),1);S(g.length,D)})).then(function(){return(b.length>0||M&&typeof t=="object")&&f.mutate({trans:i,type:"put",keys:x,values:b,criteria:M,changeSpec:typeof t!="function"&&t}).then(function(D){return S(b.length,D)})}).then(function(){return(C.length>0||M&&t===Xt)&&f.mutate({trans:i,type:"delete",keys:C,criteria:M}).then(function(D){return S(C.length,D)})}).then(function(){return v.length>h+d&&c(h+w)})})};return c(0).then(function(){if(T.length>0)throw new Rt("Error modifying one or more objects",T,E,k);return v.length})})})},e.prototype.delete=function(){var t=this._ctx,n=t.range;return Oe(t)&&(t.isPrimKey&&!da||n.type===3)?this._write(function(r){var i=t.table.core.schema.primaryKey,u=n;return t.table.core.count({trans:r,query:{index:i,range:u}}).then(function(o){return t.table.core.mutate({trans:r,type:"deleteRange",range:u}).then(function(s){var f=s.failures;s.lastResult,s.results;var y=s.numFailures;if(y)throw new Rt("Could not delete some values",Object.keys(f).map(function(m){return f[m]}),o-y);return o-y})})}):this.modify(Xt)},e}(),Xt=function(e,t){return t.value=null};function ba(e){return dt(_a.prototype,function(n,r){this.db=e;var i=Yr,u=null;if(r)try{i=r()}catch(y){u=y}var o=n._ctx,s=o.table,f=s.hook.reading.fire;this._ctx={table:s,index:o.index,isPrimKey:!o.index||s.schema.primKey.keyPath&&o.index===s.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:u,or:o.or,valueMapper:f!==ct?f:null}})}function wa(e,t){return e<t?-1:e===t?0:1}function Ea(e,t){return e>t?-1:e===t?0:1}function te(e,t,n){var r=e instanceof Xr?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Be(e){return new e.Collection(e,function(){return qr("")}).limit(0)}function xa(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function ka(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function Aa(e,t,n,r,i,u){for(var o=Math.min(e.length,r.length),s=-1,f=0;f<o;++f){var y=t[f];if(y!==r[f])return i(e[f],n[f])<0?e.substr(0,f)+n[f]+n.substr(f+1):i(e[f],r[f])<0?e.substr(0,f)+r[f]+n.substr(f+1):s>=0?e.substr(0,s)+t[s]+n.substr(s+1):null;i(e[f],y)<0&&(s=f)}return o<r.length&&u==="next"?e+n.substr(e.length):o<e.length&&u==="prev"?e.substr(0,n.length):s<0?null:e.substr(0,s)+r[s]+n.substr(s+1)}function _t(e,t,n,r){var i,u,o,s,f,y,m,_=n.length;if(!n.every(function(k){return typeof k=="string"}))return te(e,Wr);function w(k){i=xa(k),u=ka(k),o=k==="next"?wa:Ea;var S=n.map(function(v){return{lower:u(v),upper:i(v)}}).sort(function(v,c){return o(v.lower,c.lower)});s=S.map(function(v){return v.upper}),f=S.map(function(v){return v.lower}),y=k,m=k==="next"?"":r}w("next");var T=new e.Collection(e,function(){return _e(s[0],f[_-1]+r)});T._ondirectionchange=function(k){w(k)};var E=0;return T._addAlgorithm(function(k,S,v){var c=k.key;if(typeof c!="string")return!1;var h=u(c);if(t(h,f,E))return!0;for(var d=null,l=E;l<_;++l){var g=Aa(c,h,s[l],f[l],o,y);g===null&&d===null?E=l+1:(d===null||o(d,g)>0)&&(d=g)}return S(d!==null?function(){k.continue(d+m)}:v),!1}),T}function _e(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function qr(e){return{type:1,lower:e,upper:e}}var Xr=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(t,n)>0||this._cmp(t,n)===0&&(r||i)&&!(r&&i)?Be(this):new this.Collection(this,function(){return _e(t,n,!r,!i)})}catch{return te(this,ce)}},e.prototype.equals=function(t){return t==null?te(this,ce):new this.Collection(this,function(){return qr(t)})},e.prototype.above=function(t){return t==null?te(this,ce):new this.Collection(this,function(){return _e(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?te(this,ce):new this.Collection(this,function(){return _e(t,void 0,!1)})},e.prototype.below=function(t){return t==null?te(this,ce):new this.Collection(this,function(){return _e(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?te(this,ce):new this.Collection(this,function(){return _e(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?te(this,Wr):this.between(t,t+Te,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):_t(this,function(n,r){return n.indexOf(r[0])===0},[t],Te)},e.prototype.equalsIgnoreCase=function(t){return _t(this,function(n,r){return n===r[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=fe.apply(Me,arguments);return t.length===0?Be(this):_t(this,function(n,r){return r.indexOf(n)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=fe.apply(Me,arguments);return t.length===0?Be(this):_t(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},t,Te)},e.prototype.anyOf=function(){var t=this,n=fe.apply(Me,arguments),r=this._cmp;try{n.sort(r)}catch{return te(this,ce)}if(n.length===0)return Be(this);var i=new this.Collection(this,function(){return _e(n[0],n[n.length-1])});i._ondirectionchange=function(o){r=o==="next"?t._ascending:t._descending,n.sort(r)};var u=0;return i._addAlgorithm(function(o,s,f){for(var y=o.key;r(y,n[u])>0;)if(++u,u===n.length)return s(f),!1;return r(y,n[u])===0?!0:(s(function(){o.continue(n[u])}),!1)}),i},e.prototype.notEqual=function(t){return this.inAnyRange([[gn,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=fe.apply(Me,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return te(this,ce)}var n=t.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[gn,i]]},null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,n){var r=this,i=this._cmp,u=this._ascending,o=this._descending,s=this._min,f=this._max;if(t.length===0)return Be(this);if(!t.every(function(l){return l[0]!==void 0&&l[1]!==void 0&&u(l[0],l[1])<=0}))return te(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",B.InvalidArgument);var y=!n||n.includeLowers!==!1,m=n&&n.includeUppers===!0;function _(l,g){for(var b=0,x=l.length;b<x;++b){var C=l[b];if(i(g[0],C[1])<0&&i(g[1],C[0])>0){C[0]=s(C[0],g[0]),C[1]=f(C[1],g[1]);break}}return b===x&&l.push(g),l}var w=u;function T(l,g){return w(l[0],g[0])}var E;try{E=t.reduce(_,[]),E.sort(T)}catch{return te(this,ce)}var k=0,S=m?function(l){return u(l,E[k][1])>0}:function(l){return u(l,E[k][1])>=0},v=y?function(l){return o(l,E[k][0])>0}:function(l){return o(l,E[k][0])>=0};function c(l){return!S(l)&&!v(l)}var h=S,d=new this.Collection(this,function(){return _e(E[0][0],E[E.length-1][1],!y,!m)});return d._ondirectionchange=function(l){l==="next"?(h=S,w=u):(h=v,w=o),E.sort(T)},d._addAlgorithm(function(l,g,b){for(var x=l.key;h(x);)if(++k,k===E.length)return g(b),!1;return c(x)?!0:(r._cmp(x,E[k][1])===0||r._cmp(x,E[k][0])===0||g(function(){w===u?l.continue(E[k][0]):l.continue(E[k][1])}),!1)}),d},e.prototype.startsWithAnyOf=function(){var t=fe.apply(Me,arguments);return t.every(function(n){return typeof n=="string"})?t.length===0?Be(this):this.inAnyRange(t.map(function(n){return[n,n+Te]})):te(this,"startsWithAnyOf() only works with strings")},e}();function Sa(e){return dt(Xr.prototype,function(n,r,i){this.db=e,this._ctx={table:n,index:r===":id"?null:r,or:i};var u=e._deps.indexedDB;if(!u)throw new B.MissingAPI;this._cmp=this._ascending=u.cmp.bind(u),this._descending=function(o,s){return u.cmp(s,o)},this._max=function(o,s){return u.cmp(o,s)>0?o:s},this._min=function(o,s){return u.cmp(o,s)<0?o:s},this._IDBKeyRange=e._deps.IDBKeyRange})}function oe(e){return j(function(t){return et(t),e(t.target.error),!1})}function et(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var tt="storagemutated",we="x-storagemutated-1",ke=ht(null,tt),Ta=function(){function e(){}return e.prototype._lock=function(){return Ve(!O.global),++this._reculock,this._reculock===1&&!O.global&&(O.lockOwnerFor=this),this},e.prototype._unlock=function(){if(Ve(!O.global),--this._reculock===0)for(O.global||(O.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{Ue(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&O.lockOwnerFor!==this},e.prototype.create=function(t){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(Ve(!this.idbtrans),!t&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new B.DatabaseClosed(i);case"MissingAPIError":throw new B.MissingAPI(i.message,i);default:throw new B.OpenFailed(i)}if(!this.active)throw new B.TransactionInactive;return Ve(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=j(function(u){et(u),n._reject(t.error)}),t.onabort=j(function(u){et(u),n.active&&n._reject(new B.Abort(t.error)),n.active=!1,n.on("abort").fire(u)}),t.oncomplete=j(function(){n.active=!1,n._resolve(),"mutatedParts"in t&&ke.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,n,r){var i=this;if(t==="readwrite"&&this.mode!=="readwrite")return V(new B.ReadOnly("Transaction is readonly"));if(!this.active)return V(new B.TransactionInactive);if(this._locked())return new I(function(o,s){i._blockedFuncs.push([function(){i._promise(t,n,r).then(o,s)},O])});if(r)return Ee(function(){var o=new I(function(s,f){i._lock();var y=n(s,f,i);y&&y.then&&y.then(s,f)});return o.finally(function(){return i._unlock()}),o._lib=!0,o});var u=new I(function(o,s){var f=n(o,s,i);f&&f.then&&f.then(o,s)});return u._lib=!0,u},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var n=this._root(),r=I.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function o(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=o)})()}var u=n._waitingFor;return new I(function(o,s){r.then(function(f){return n._waitingQueue.push(j(o.bind(null,f)))},function(f){return n._waitingQueue.push(j(s.bind(null,f)))}).finally(function(){n._waitingFor===u&&(n._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new B.Abort))},e.prototype.table=function(t){var n=this._memoizedTables||(this._memoizedTables={});if(ie(n,t))return n[t];var r=this.schema[t];if(!r)throw new B.NotFound("Table "+t+" not part of transaction");var i=new this.db.Table(t,r,this);return i.core=this.db.core.table(t),n[t]=i,i},e}();function Ca(e){return dt(Ta.prototype,function(n,r,i,u,o){var s=this;this.db=e,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=u,this.idbtrans=null,this.on=ht(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new I(function(f,y){s._resolve=f,s._reject=y}),this._completion.then(function(){s.active=!1,s.on.complete.fire()},function(f){var y=s.active;return s.active=!1,s.on.error.fire(f),s.parent?s.parent._reject(f):y&&s.idbtrans&&s.idbtrans.abort(),V(f)})})}function mn(e,t,n,r,i,u,o){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:u,src:(n&&!o?"&":"")+(r?"*":"")+(i?"++":"")+Qr(t)}}function Qr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function Jr(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:Rr(n,function(r){return[r.name,r]})}}function Ra(e){return e.length===1?e[0]:e}var nt=function(e){try{return e.only([[]]),nt=function(){return[[]]},[[]]}catch{return nt=function(){return Te},Te}};function _n(e){return e==null?function(){}:typeof e=="string"?Ka(e):function(t){return ve(t,e)}}function Ka(e){var t=e.split(".");return t.length===1?function(n){return n[e]}:function(n){return ve(n,e)}}function fr(e){return[].slice.call(e)}var Ia=0;function qe(e){return e==null?":id":typeof e=="string"?e:"["+e.join("+")+"]"}function Pa(e,t,n){function r(_,w){var T=fr(_.objectStoreNames);return{schema:{name:_.name,tables:T.map(function(E){return w.objectStore(E)}).map(function(E){var k=E.keyPath,S=E.autoIncrement,v=q(k),c=k==null,h={},d={name:E.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:c,compound:v,keyPath:k,autoIncrement:S,unique:!0,extractKey:_n(k)},indexes:fr(E.indexNames).map(function(l){return E.index(l)}).map(function(l){var g=l.name,b=l.unique,x=l.multiEntry,C=l.keyPath,A=q(C),K={name:g,compound:A,keyPath:C,unique:b,multiEntry:x,extractKey:_n(C)};return h[qe(C)]=K,K}),getIndexByKeyPath:function(l){return h[qe(l)]}};return h[":id"]=d.primaryKey,k!=null&&(h[qe(k)]=d.primaryKey),d})},hasGetAll:T.length>0&&"getAll"in w.objectStore(T[0])&&!(typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(_){if(_.type===3)return null;if(_.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var w=_.lower,T=_.upper,E=_.lowerOpen,k=_.upperOpen,S=w===void 0?T===void 0?null:t.upperBound(T,!!k):T===void 0?t.lowerBound(w,!!E):t.bound(w,T,!!E,!!k);return S}function u(_){var w=_.name;function T(S){var v=S.trans,c=S.type,h=S.keys,d=S.values,l=S.range;return new Promise(function(g,b){g=j(g);var x=v.objectStore(w),C=x.keyPath==null,A=c==="put"||c==="add";if(!A&&c!=="delete"&&c!=="deleteRange")throw new Error("Invalid operation type: "+c);var K=(h||d||{length:1}).length;if(h&&d&&h.length!==d.length)throw new Error("Given keys array must have same length as given values array.");if(K===0)return g({numFailures:0,failures:{},results:[],lastResult:void 0});var R,M=[],D=[],P=0,L=function(ee){++P,et(ee)};if(c==="deleteRange"){if(l.type===4)return g({numFailures:P,failures:D,results:[],lastResult:void 0});l.type===3?M.push(R=x.clear()):M.push(R=x.delete(i(l)))}else{var z=A?C?[d,h]:[d,null]:[h,null],ne=z[0],W=z[1];if(A)for(var X=0;X<K;++X)M.push(R=W&&W[X]!==void 0?x[c](ne[X],W[X]):x[c](ne[X])),R.onerror=L;else for(var X=0;X<K;++X)M.push(R=x[c](ne[X])),R.onerror=L}var G=function(ee){var ae=ee.target.result;M.forEach(function(Q,De){return Q.error!=null&&(D[De]=Q.error)}),g({numFailures:P,failures:D,results:c==="delete"?h:M.map(function(Q){return Q.result}),lastResult:ae})};R.onerror=function(ee){L(ee),G(ee)},R.onsuccess=G})}function E(S){var v=S.trans,c=S.values,h=S.query,d=S.reverse,l=S.unique;return new Promise(function(g,b){g=j(g);var x=h.index,C=h.range,A=v.objectStore(w),K=x.isPrimaryKey?A:A.index(x.name),R=d?l?"prevunique":"prev":l?"nextunique":"next",M=c||!("openKeyCursor"in K)?K.openCursor(i(C),R):K.openKeyCursor(i(C),R);M.onerror=oe(b),M.onsuccess=j(function(D){var P=M.result;if(!P){g(null);return}P.___id=++Ia,P.done=!1;var L=P.continue.bind(P),z=P.continuePrimaryKey;z&&(z=z.bind(P));var ne=P.advance.bind(P),W=function(){throw new Error("Cursor not started")},X=function(){throw new Error("Cursor not stopped")};P.trans=v,P.stop=P.continue=P.continuePrimaryKey=P.advance=W,P.fail=j(b),P.next=function(){var G=this,ee=1;return this.start(function(){return ee--?G.continue():G.stop()}).then(function(){return G})},P.start=function(G){var ee=new Promise(function(Q,De){Q=j(Q),M.onerror=oe(De),P.fail=De,P.stop=function(me){P.stop=P.continue=P.continuePrimaryKey=P.advance=X,Q(me)}}),ae=function(){if(M.result)try{G()}catch(Q){P.fail(Q)}else P.done=!0,P.start=function(){throw new Error("Cursor behind last entry")},P.stop()};return M.onsuccess=j(function(Q){M.onsuccess=ae,ae()}),P.continue=L,P.continuePrimaryKey=z,P.advance=ne,ae(),ee},g(P)},b)})}function k(S){return function(v){return new Promise(function(c,h){c=j(c);var d=v.trans,l=v.values,g=v.limit,b=v.query,x=g===1/0?void 0:g,C=b.index,A=b.range,K=d.objectStore(w),R=C.isPrimaryKey?K:K.index(C.name),M=i(A);if(g===0)return c({result:[]});if(S){var D=l?R.getAll(M,x):R.getAllKeys(M,x);D.onsuccess=function(ne){return c({result:ne.target.result})},D.onerror=oe(h)}else{var P=0,L=l||!("openKeyCursor"in R)?R.openCursor(M):R.openKeyCursor(M),z=[];L.onsuccess=function(ne){var W=L.result;if(!W)return c({result:z});if(z.push(l?W.value:W.primaryKey),++P===g)return c({result:z});W.continue()},L.onerror=oe(h)}})}}return{name:w,schema:_,mutate:T,getMany:function(S){var v=S.trans,c=S.keys;return new Promise(function(h,d){h=j(h);for(var l=v.objectStore(w),g=c.length,b=new Array(g),x=0,C=0,A,K=function(P){var L=P.target;(b[L._pos]=L.result)!=null,++C===x&&h(b)},R=oe(d),M=0;M<g;++M){var D=c[M];D!=null&&(A=l.get(c[M]),A._pos=M,A.onsuccess=K,A.onerror=R,++x)}x===0&&h(b)})},get:function(S){var v=S.trans,c=S.key;return new Promise(function(h,d){h=j(h);var l=v.objectStore(w),g=l.get(c);g.onsuccess=function(b){return h(b.target.result)},g.onerror=oe(d)})},query:k(f),openCursor:E,count:function(S){var v=S.query,c=S.trans,h=v.index,d=v.range;return new Promise(function(l,g){var b=c.objectStore(w),x=h.isPrimaryKey?b:b.index(h.name),C=i(d),A=C?x.count(C):x.count();A.onsuccess=j(function(K){return l(K.target.result)}),A.onerror=oe(g)})}}}var o=r(e,n),s=o.schema,f=o.hasGetAll,y=s.tables.map(function(_){return u(_)}),m={};return y.forEach(function(_){return m[_.name]=_}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(_){var w=m[_];if(!w)throw new Error("Table '"+_+"' not found");return m[_]},MIN_KEY:-1/0,MAX_KEY:nt(t),schema:s}}function Da(e,t){return t.reduce(function(n,r){var i=r.create;return F(F({},n),i(n))},e)}function Oa(e,t,n,r){var i=n.IDBKeyRange;n.indexedDB;var u=Da(Pa(t,i,r),e.dbcore);return{dbcore:u}}function $n(e,t){var n=e._novip,r=t.db,i=Oa(n._middlewares,r,n._deps,t);n.core=i.dbcore,n.tables.forEach(function(u){var o=u.name;n.core.schema.tables.some(function(s){return s.name===o})&&(u.core=n.core.table(o),n[o]instanceof n.Table&&(n[o].core=u.core))})}function Bt(e,t,n,r){var i=e._novip;n.forEach(function(u){var o=r[u];t.forEach(function(s){var f=In(s,u);(!f||"value"in f&&f.value===void 0)&&(s===i.Transaction.prototype||s instanceof i.Transaction?ye(s,u,{get:function(){return this.table(u)},set:function(y){Sr(this,u,{value:y,writable:!0,configurable:!0,enumerable:!0})}}):s[u]=new i.Table(u,o))})})}function bn(e,t){var n=e._novip;t.forEach(function(r){for(var i in r)r[i]instanceof n.Table&&delete r[i]})}function Ba(e,t){return e._cfg.version-t._cfg.version}function Ma(e,t,n,r){var i=e._dbSchema,u=e._createTransaction("readwrite",e._storeNames,i);u.create(n),u._completion.catch(r);var o=u._reject.bind(u),s=O.transless||O;Ee(function(){O.trans=u,O.transless=s,t===0?(H(i).forEach(function(f){jn(n,f,i[f].primKey,i[f].indexes)}),$n(e,n),I.follow(function(){return e.on.populate.fire(u)}).catch(o)):Fa(e,t,u,n).catch(o)})}function Fa(e,t,n,r){var i=e._novip,u=[],o=i._versions,s=i._dbSchema=Hn(i,i.idbdb,r),f=!1,y=o.filter(function(_){return _._cfg.version>=t});y.forEach(function(_){u.push(function(){var w=s,T=_._cfg.dbschema;En(i,w,r),En(i,T,r),s=i._dbSchema=T;var E=Zr(w,T);E.add.forEach(function(d){jn(r,d[0],d[1].primKey,d[1].indexes)}),E.change.forEach(function(d){if(d.recreate)throw new B.Upgrade("Not yet support for changing primary key");var l=r.objectStore(d.name);d.add.forEach(function(g){return wn(l,g)}),d.change.forEach(function(g){l.deleteIndex(g.name),wn(l,g)}),d.del.forEach(function(g){return l.deleteIndex(g)})});var k=_._cfg.contentUpgrade;if(k&&_._cfg.version>t){$n(i,r),n._memoizedTables={},f=!0;var S=Kr(T);E.del.forEach(function(d){S[d]=w[d]}),bn(i,[i.Transaction.prototype]),Bt(i,[i.Transaction.prototype],H(S),S),n.schema=S;var v=Pn(k);v&&He();var c,h=I.follow(function(){if(c=k(n),c&&v){var d=ge.bind(null,null);c.then(d,d)}});return c&&typeof c.then=="function"?I.resolve(c):h.then(function(){return c})}}),u.push(function(w){if(!f||!ha){var T=_._cfg.dbschema;Na(T,w)}bn(i,[i.Transaction.prototype]),Bt(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema})});function m(){return u.length?I.resolve(u.shift()(n.idbtrans)).then(m):I.resolve()}return m().then(function(){La(s,r)})}function Zr(e,t){var n={del:[],add:[],change:[]},r;for(r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],u=t[r];if(!i)n.add.push([r,u]);else{var o={name:r,def:u,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(u.primKey.keyPath||"")||i.primKey.auto!==u.primKey.auto&&!Ht)o.recreate=!0,n.change.push(o);else{var s=i.idxByName,f=u.idxByName,y=void 0;for(y in s)f[y]||o.del.push(y);for(y in f){var m=s[y],_=f[y];m?m.src!==_.src&&o.change.push(_):o.add.push(_)}(o.del.length>0||o.add.length>0||o.change.length>0)&&n.change.push(o)}}}return n}function jn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(u){return wn(i,u)}),i}function La(e,t){H(e).forEach(function(n){t.db.objectStoreNames.contains(n)||jn(t,n,e[n].primKey,e[n].indexes)})}function Na(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return e[n]==null&&t.db.deleteObjectStore(n)})}function wn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Hn(e,t,n){var r={},i=$t(t.objectStoreNames,0);return i.forEach(function(u){for(var o=n.objectStore(u),s=o.keyPath,f=mn(Qr(s),s||"",!1,!1,!!o.autoIncrement,s&&typeof s!="string",!0),y=[],m=0;m<o.indexNames.length;++m){var _=o.index(o.indexNames[m]);s=_.keyPath;var w=mn(_.name,s,!!_.unique,!!_.multiEntry,!1,s&&typeof s!="string",!1);y.push(w)}r[u]=Jr(u,f,y)}),r}function $a(e,t,n){var r=e._novip;r.verno=t.version/10;var i=r._dbSchema=Hn(r,t,n);r._storeNames=$t(t.objectStoreNames,0),Bt(r,[r._allTables],H(i),i)}function ja(e,t){var n=Hn(e,e.idbdb,t),r=Zr(n,e._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function En(e,t,n){for(var r=e._novip,i=n.db.objectStoreNames,u=0;u<i.length;++u){var o=i[u],s=n.objectStore(o);r._hasGetAll="getAll"in s;for(var f=0;f<s.indexNames.length;++f){var y=s.indexNames[f],m=s.index(y).keyPath,_=typeof m=="string"?m:"["+$t(m).join("+")+"]";if(t[o]){var w=t[o].idxByName[_];w&&(w.name=y,delete t[o].idxByName[_],t[o].idxByName[y]=w)}}}typeof navigator!="undefined"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&$.WorkerGlobalScope&&$ instanceof $.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}function Ha(e){return e.split(",").map(function(t,n){t=t.trim();var r=t.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(r)?r.match(/^\[(.*)\]$/)[1].split("+"):r;return mn(r,i||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),q(i),n===0)})}var Ua=function(){function e(){}return e.prototype._parseStoresSpec=function(t,n){H(t).forEach(function(r){if(t[r]!==null){var i=Ha(t[r]),u=i.shift();if(u.multi)throw new B.Schema("Primary key cannot be multi-valued");i.forEach(function(o){if(o.auto)throw new B.Schema("Only primary key can be marked as autoIncrement (++)");if(!o.keyPath)throw new B.Schema("Index must have a name and cannot be an empty string")}),n[r]=Jr(r,u,i)}})},e.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?Z(this._cfg.storesSource,t):t;var r=n._versions,i={},u={};return r.forEach(function(o){Z(i,o._cfg.storesSource),u=o._cfg.dbschema={},o._parseStoresSpec(i,u)}),n._dbSchema=u,bn(n,[n._allTables,n,n.Transaction.prototype]),Bt(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],H(u),u),n._storeNames=H(u),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=Bn(this._cfg.contentUpgrade||N,t),this},e}();function za(e){return dt(Ua.prototype,function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function Un(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new ni(Ut,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function zn(e){return e&&typeof e.databases=="function"}function Va(e){var t=e.indexedDB,n=e.IDBKeyRange;return zn(t)?Promise.resolve(t.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==Ut})}):Un(t,n).toCollection().primaryKeys()}function Wa(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!zn(n)&&t!==Ut&&Un(n,r).put({name:t}).catch(N)}function Ga(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!zn(n)&&t!==Ut&&Un(n,r).delete(t).catch(N)}function xn(e){return Ee(function(){return O.letThrough=!0,e()})}function Ya(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};t=setInterval(r,100),r()}).finally(function(){return clearInterval(t)})}function qa(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?V(t.dbOpenError):e});se&&(t.openCanceller._stackHolder=Pe()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller;function i(){if(t.openCanceller!==r)throw new B.DatabaseClosed("db.open() was cancelled")}var u=t.dbReadyResolve,o=null,s=!1;return I.race([r,(typeof navigator=="undefined"?I.resolve():Ya()).then(function(){return new I(function(f,y){if(i(),!n)throw new B.MissingAPI;var m=e.name,_=t.autoSchema?n.open(m):n.open(m,Math.round(e.verno*10));if(!_)throw new B.MissingAPI;_.onerror=oe(y),_.onblocked=j(e._fireOnBlocked),_.onupgradeneeded=j(function(w){if(o=_.transaction,t.autoSchema&&!e._options.allowEmptyDB){_.onerror=et,o.abort(),_.result.close();var T=n.deleteDatabase(m);T.onsuccess=T.onerror=j(function(){y(new B.NoSuchDatabase("Database "+m+" doesnt exist"))})}else{o.onerror=oe(y);var E=w.oldVersion>Math.pow(2,62)?0:w.oldVersion;s=E<1,e._novip.idbdb=_.result,Ma(e,E/10,o,y)}},y),_.onsuccess=j(function(){o=null;var w=e._novip.idbdb=_.result,T=$t(w.objectStoreNames);if(T.length>0)try{var E=w.transaction(Ra(T),"readonly");t.autoSchema?$a(e,w,E):(En(e,e._dbSchema,E),ja(e,E)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),$n(e,E)}catch{}Ye.push(e),w.onversionchange=j(function(k){t.vcFired=!0,e.on("versionchange").fire(k)}),w.onclose=j(function(k){e.on("close").fire(k)}),s&&Wa(e._deps,m),f()},y)})})]).then(function(){return i(),t.onReadyBeingFired=[],I.resolve(xn(function(){return e.on.ready.fire(e.vip)})).then(function f(){if(t.onReadyBeingFired.length>0){var y=t.onReadyBeingFired.reduce(Bn,N);return t.onReadyBeingFired=[],I.resolve(xn(function(){return y(e.vip)})).then(f)}})}).finally(function(){t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(function(){return e}).catch(function(f){t.dbOpenError=f;try{o&&o.abort()}catch{}return r===t.openCanceller&&e._close(),V(f)}).finally(function(){t.openComplete=!0,u()})}function kn(e){var t=function(o){return e.next(o)},n=function(o){return e.throw(o)},r=u(t),i=u(n);function u(o){return function(s){var f=o(s),y=f.value;return f.done?y:!y||typeof y.then!="function"?q(y)?Promise.all(y).then(r,i):r(y):y.then(r,i)}}return u(t)()}function Xa(e,t,n){var r=arguments.length;if(r<2)throw new B.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var u=Ir(i);return[e,u,n]}function ei(e,t,n,r,i){return I.resolve().then(function(){var u=O.transless||O,o=e._createTransaction(t,n,e._dbSchema,r),s={trans:o,transless:u};if(r)o.idbtrans=r.idbtrans;else try{o.create(),e._state.PR1398_maxLoop=3}catch(_){return _.name===On.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(function(){return ei(e,t,n,null,i)})):V(_)}var f=Pn(i);f&&He();var y,m=I.follow(function(){if(y=i.call(o,o),y)if(f){var _=ge.bind(null,null);y.then(_,_)}else typeof y.next=="function"&&typeof y.throw=="function"&&(y=kn(y))},s);return(y&&typeof y.then=="function"?I.resolve(y).then(function(_){return o.active?_:V(new B.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):m.then(function(){return y})).then(function(_){return r&&o._resolve(),o._completion.then(function(){return _})}).catch(function(_){return o._reject(_),V(_)})})}function bt(e,t,n){for(var r=q(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function Qa(e){return F(F({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},u=[];function o(k,S,v){var c=qe(k),h=i[c]=i[c]||[],d=k==null?0:typeof k=="string"?1:k.length,l=S>0,g=F(F({},v),{isVirtual:l,keyTail:S,keyLength:d,extractKey:_n(k),unique:!l&&v.unique});if(h.push(g),g.isPrimaryKey||u.push(g),d>1){var b=d===2?k[0]:k.slice(0,d-1);o(b,S+1,v)}return h.sort(function(x,C){return x.keyTail-C.keyTail}),g}var s=o(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[s];for(var f=0,y=r.indexes;f<y.length;f++){var m=y[f];o(m.keyPath,0,m)}function _(k){var S=i[qe(k)];return S&&S[0]}function w(k,S){return{type:k.type===1?2:k.type,lower:bt(k.lower,k.lowerOpen?e.MAX_KEY:e.MIN_KEY,S),lowerOpen:!0,upper:bt(k.upper,k.upperOpen?e.MIN_KEY:e.MAX_KEY,S),upperOpen:!0}}function T(k){var S=k.query.index;return S.isVirtual?F(F({},k),{query:{index:S,range:w(k.query.range,S.keyTail)}}):k}var E=F(F({},n),{schema:F(F({},r),{primaryKey:s,indexes:u,getIndexByKeyPath:_}),count:function(k){return n.count(T(k))},query:function(k){return n.query(T(k))},openCursor:function(k){var S=k.query.index,v=S.keyTail,c=S.isVirtual,h=S.keyLength;if(!c)return n.openCursor(k);function d(l){function g(x){x!=null?l.continue(bt(x,k.reverse?e.MAX_KEY:e.MIN_KEY,v)):k.unique?l.continue(l.key.slice(0,h).concat(k.reverse?e.MIN_KEY:e.MAX_KEY,v)):l.continue()}var b=Object.create(l,{continue:{value:g},continuePrimaryKey:{value:function(x,C){l.continuePrimaryKey(bt(x,e.MAX_KEY,v),C)}},primaryKey:{get:function(){return l.primaryKey}},key:{get:function(){var x=l.key;return h===1?x[0]:x.slice(0,h)}},value:{get:function(){return l.value}}});return b}return n.openCursor(T(k)).then(function(l){return l&&d(l)})}});return E}})}var Ja={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Qa};function Vn(e,t,n,r){return n=n||{},r=r||"",H(e).forEach(function(i){if(!ie(t,i))n[r+i]=void 0;else{var u=e[i],o=t[i];if(typeof u=="object"&&typeof o=="object"&&u&&o){var s=an(u),f=an(o);s!==f?n[r+i]=t[i]:s==="Object"?Vn(u,o,n,r+i+"."):u!==o&&(n[r+i]=t[i])}else u!==o&&(n[r+i]=t[i])}}),H(t).forEach(function(i){ie(e,i)||(n[r+i]=t[i])}),n}function Za(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var eu={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return F(F({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey,i=F(F({},n),{mutate:function(u){var o=O.trans,s=o.table(t).hook,f=s.deleting,y=s.creating,m=s.updating;switch(u.type){case"add":if(y.fire===N)break;return o._promise("readwrite",function(){return _(u)},!0);case"put":if(y.fire===N&&m.fire===N)break;return o._promise("readwrite",function(){return _(u)},!0);case"delete":if(f.fire===N)break;return o._promise("readwrite",function(){return _(u)},!0);case"deleteRange":if(f.fire===N)break;return o._promise("readwrite",function(){return w(u)},!0)}return n.mutate(u);function _(E){var k=O.trans,S=E.keys||Za(r,E);if(!S)throw new Error("Keys missing");return E=E.type==="add"||E.type==="put"?F(F({},E),{keys:S}):F({},E),E.type!=="delete"&&(E.values=nn([],E.values,!0)),E.keys&&(E.keys=nn([],E.keys,!0)),tu(n,E,S).then(function(v){var c=S.map(function(h,d){var l=v[d],g={onerror:null,onsuccess:null};if(E.type==="delete")f.fire.call(g,h,l,k);else if(E.type==="add"||l===void 0){var b=y.fire.call(g,h,E.values[d],k);h==null&&b!=null&&(h=b,E.keys[d]=h,r.outbound||ue(E.values[d],r.keyPath,h))}else{var x=Vn(l,E.values[d]),C=m.fire.call(g,x,h,l,k);if(C){var A=E.values[d];Object.keys(C).forEach(function(K){ie(A,K)?A[K]=C[K]:ue(A,K,C[K])})}}return g});return n.mutate(E).then(function(h){for(var d=h.failures,l=h.results,g=h.numFailures,b=h.lastResult,x=0;x<S.length;++x){var C=l?l[x]:S[x],A=c[x];C==null?A.onerror&&A.onerror(d[x]):A.onsuccess&&A.onsuccess(E.type==="put"&&v[x]?E.values[x]:C)}return{failures:d,results:l,numFailures:g,lastResult:b}}).catch(function(h){return c.forEach(function(d){return d.onerror&&d.onerror(h)}),Promise.reject(h)})})}function w(E){return T(E.trans,E.range,1e4)}function T(E,k,S){return n.query({trans:E,values:!1,query:{index:r,range:k},limit:S}).then(function(v){var c=v.result;return _({type:"delete",keys:c,trans:E}).then(function(h){return h.numFailures>0?Promise.reject(h.failures[0]):c.length<S?{failures:[],numFailures:0,lastResult:void 0}:T(E,F(F({},k),{lower:c[c.length-1],lowerOpen:!0}),S)})})}}});return i}})}};function tu(e,t,n){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function ti(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,u=0;i<t.keys.length&&u<e.length;++i)J(t.keys[i],e[u])===0&&(r.push(n?st(t.values[i]):t.values[i]),++u);return r.length===e.length?r:null}catch{return null}}var nu={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return F(F({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=ti(r.keys,r.trans._cache,r.cache==="clone");return i?I.resolve(i):n.getMany(r).then(function(u){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?st(u):u},u})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}},Qt;function Wn(e){return!("from"in e)}var le=function(e,t){if(this)Z(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var n=new le;return e&&"d"in e&&Z(n,e),n}};Ne(le.prototype,(Qt={add:function(e){return Mt(this,e),this},addKey:function(e){return rt(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return rt(t,n,n)}),this}},Qt[un]=function(){return An(this)},Qt));function rt(e,t,n){var r=J(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(Wn(e))return Z(e,{from:t,to:n,d:1});var i=e.l,u=e.r;if(J(n,e.from)<0)return i?rt(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},hr(e);if(J(t,e.to)>0)return u?rt(u,t,n):e.r={from:t,to:n,d:1,l:null,r:null},hr(e);J(t,e.from)<0&&(e.from=t,e.l=null,e.d=u?u.d+1:1),J(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var o=!e.r;i&&!e.l&&Mt(e,i),u&&o&&Mt(e,u)}}function Mt(e,t){function n(r,i){var u=i.from,o=i.to,s=i.l,f=i.r;rt(r,u,o),s&&n(r,s),f&&n(r,f)}Wn(t)||n(e,t)}function ru(e,t){var n=An(t),r=n.next();if(r.done)return!1;for(var i=r.value,u=An(e),o=u.next(i.from),s=o.value;!r.done&&!o.done;){if(J(s.from,i.to)<=0&&J(s.to,i.from)>=0)return!0;J(i.from,s.from)<0?i=(r=n.next(s.from)).value:s=(o=u.next(i.from)).value}return!1}function An(e){var t=Wn(e)?null:{s:0,n:e};return{next:function(n){for(var r=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&J(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||J(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function hr(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var u=i==="r"?"l":"r",o=F({},e),s=e[i];e.from=s.from,e.to=s.to,e[i]=s[i],o[i]=s[u],e[u]=o,o.d=dr(o)}e.d=dr(e)}function dr(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}var iu={stack:"dbcore",level:0,create:function(e){var t=e.schema.name,n=new le(e.MIN_KEY,e.MAX_KEY);return F(F({},e),{table:function(r){var i=e.table(r),u=i.schema,o=u.primaryKey,s=o.extractKey,f=o.outbound,y=F(F({},i),{mutate:function(w){var T=w.trans,E=T.mutatedParts||(T.mutatedParts={}),k=function(b){var x="idb://"+t+"/"+r+"/"+b;return E[x]||(E[x]=new le)},S=k(""),v=k(":dels"),c=w.type,h=w.type==="deleteRange"?[w.range]:w.type==="delete"?[w.keys]:w.values.length<50?[[],w.values]:[],d=h[0],l=h[1],g=w.trans._cache;return i.mutate(w).then(function(b){if(q(d)){c!=="delete"&&(d=b.results),S.addKeys(d);var x=ti(d,g);!x&&c!=="add"&&v.addKeys(d),(x||l)&&au(k,u,x,l)}else if(d){var C={from:d.lower,to:d.upper};v.add(C),S.add(C)}else S.add(n),v.add(n),u.indexes.forEach(function(A){return k(A.name).add(n)});return b})}}),m=function(w){var T,E,k=w.query,S=k.index,v=k.range;return[S,new le((T=v.lower)!==null&&T!==void 0?T:e.MIN_KEY,(E=v.upper)!==null&&E!==void 0?E:e.MAX_KEY)]},_={get:function(w){return[o,new le(w.key)]},getMany:function(w){return[o,new le().addKeys(w.keys)]},count:m,query:m,openCursor:m};return H(_).forEach(function(w){y[w]=function(T){var E=O.subscr;if(E){var k=function(g){var b="idb://"+t+"/"+r+"/"+g;return E[b]||(E[b]=new le)},S=k(""),v=k(":dels"),c=_[w](T),h=c[0],d=c[1];if(k(h.name||"").add(d),!h.isPrimaryKey)if(w==="count")v.add(n);else{var l=w==="query"&&f&&T.values&&i.query(F(F({},T),{values:!1}));return i[w].apply(this,arguments).then(function(g){if(w==="query"){if(f&&T.values)return l.then(function(A){var K=A.result;return S.addKeys(K),g});var b=T.values?g.result.map(s):g.result;T.values?S.addKeys(b):v.addKeys(b)}else if(w==="openCursor"){var x=g,C=T.values;return x&&Object.create(x,{key:{get:function(){return v.addKey(x.primaryKey),x.key}},primaryKey:{get:function(){var A=x.primaryKey;return v.addKey(A),A}},value:{get:function(){return C&&S.addKey(x.primaryKey),x.value}}})}return g})}}return i[w].apply(this,arguments)}}),y}})}};function au(e,t,n,r){function i(u){var o=e(u.name||"");function s(y){return y!=null?u.extractKey(y):null}var f=function(y){return u.multiEntry&&q(y)?y.forEach(function(m){return o.addKey(m)}):o.addKey(y)};(n||r).forEach(function(y,m){var _=n&&s(n[m]),w=r&&s(r[m]);J(_,w)!==0&&(_!=null&&f(_),w!=null&&f(w))})}t.indexes.forEach(i)}var ni=function(){function e(t,n){var r=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=F({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var u=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var o={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:N,dbReadyPromise:null,cancelOpen:N,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};o.dbReadyPromise=new I(function(s){o.dbReadyResolve=s}),o.openCanceller=new I(function(s,f){o.cancelOpen=f}),this._state=o,this.name=t,this.on=ht(this,"populate","blocked","versionchange","close",{ready:[Bn,N]}),this.on.ready.subscribe=Tr(this.on.ready.subscribe,function(s){return function(f,y){e.vip(function(){var m=r._state;if(m.openComplete)m.dbOpenError||I.resolve().then(f),y&&s(f);else if(m.onReadyBeingFired)m.onReadyBeingFired.push(f),y&&s(f);else{s(f);var _=r;y||s(function w(){_.on.ready.unsubscribe(f),_.on.ready.unsubscribe(w)})}})}}),this.Collection=ba(this),this.Table=va(this),this.Transaction=Ca(this),this.Version=za(this),this.WhereClause=Sa(this),this.on("versionchange",function(s){s.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()}),this.on("blocked",function(s){!s.newVersion||s.newVersion<s.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+s.oldVersion/10)}),this._maxKey=nt(n.IDBKeyRange),this._createTransaction=function(s,f,y,m){return new r.Transaction(s,f,y,r._options.chromeTransactionDurability,m)},this._fireOnBlocked=function(s){r.on("blocked").fire(s),Ye.filter(function(f){return f.name===r.name&&f!==r&&!f._state.vcFired}).map(function(f){return f.on("versionchange").fire(s)})},this.use(Ja),this.use(eu),this.use(iu),this.use(nu),this.vip=Object.create(this,{_vip:{value:!0}}),u.forEach(function(s){return s(r)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new B.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new B.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=this._versions,r=n.filter(function(i){return i._cfg.version===t})[0];return r||(r=new this.Version(t),n.push(r),n.sort(Ba),r.stores({}),this._state.autoSchema=!1,r)},e.prototype._whenReady=function(t){var n=this;return this.idbdb&&(this._state.openComplete||O.letThrough||this._vip)?t():new I(function(r,i){if(n._state.openComplete)return i(new B.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._options.autoOpen){i(new B.DatabaseClosed);return}n.open().catch(N)}n._state.dbReadyPromise.then(r,i)}).then(t)},e.prototype.use=function(t){var n=t.stack,r=t.create,i=t.level,u=t.name;u&&this.unuse({stack:n,name:u});var o=this._middlewares[n]||(this._middlewares[n]=[]);return o.push({stack:n,create:r,level:i==null?10:i,name:u}),o.sort(function(s,f){return s.level-f.level}),this},e.prototype.unuse=function(t){var n=t.stack,r=t.name,i=t.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(u){return i?u.create!==i:r?u.name!==r:!1})),this},e.prototype.open=function(){return qa(this)},e.prototype._close=function(){var t=this._state,n=Ye.indexOf(this);if(n>=0&&Ye.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new I(function(r){t.dbReadyResolve=r}),t.openCanceller=new I(function(r,i){t.cancelOpen=i})},e.prototype.close=function(){this._close();var t=this._state;this._options.autoOpen=!1,t.dbOpenError=new B.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)},e.prototype.delete=function(){var t=this,n=arguments.length>0,r=this._state;return new I(function(i,u){var o=function(){t.close();var s=t._deps.indexedDB.deleteDatabase(t.name);s.onsuccess=j(function(){Ga(t._deps,t.name),i()}),s.onerror=oe(u),s.onblocked=t._fireOnBlocked};if(n)throw new B.InvalidArgument("Arguments not allowed in db.delete()");r.isBeingOpened?r.dbReadyPromise.then(o):o()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return H(this._allTables).map(function(n){return t._allTables[n]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=Xa.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,n,r){var i=this,u=O.trans;(!u||u.db!==this||t.indexOf("!")!==-1)&&(u=null);var o=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var s,f;try{if(f=n.map(function(m){var _=m instanceof i.Table?m.name:m;if(typeof _!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return _}),t=="r"||t===Wt)s=Wt;else if(t=="rw"||t==Gt)s=Gt;else throw new B.InvalidArgument("Invalid transaction mode: "+t);if(u){if(u.mode===Wt&&s===Gt)if(o)u=null;else throw new B.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");u&&f.forEach(function(m){if(u&&u.storeNames.indexOf(m)===-1)if(o)u=null;else throw new B.SubTransaction("Table "+m+" not included in parent transaction.")}),o&&u&&!u.active&&(u=null)}}catch(m){return u?u._promise(null,function(_,w){w(m)}):V(m)}var y=ei.bind(null,this,s,f,u,r);return u?u._promise(s,y,"lock"):O.trans?Ue(O.transless,function(){return i._whenReady(y)}):this._whenReady(y)},e.prototype.table=function(t){if(!ie(this._allTables,t))throw new B.InvalidTable("Table "+t+" does not exist");return this._allTables[t]},e}(),uu=typeof Symbol!="undefined"&&"observable"in Symbol?Symbol.observable:"@@observable",ou=function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,n,r){return this._subscribe(!t||typeof t=="function"?{next:t,error:n,complete:r}:t)},e.prototype[uu]=function(){return this},e}();function ri(e,t){return H(t).forEach(function(n){var r=e[n]||(e[n]=new le);Mt(r,t[n])}),e}function su(e){return new ou(function(t){var n=Pn(e);function r(T){n&&He();var E=function(){return Ee(e,{subscr:T,trans:null})},k=O.trans?Ue(O.transless,E):E();return n&&k.then(ge,ge),k}var i=!1,u={},o={},s={get closed(){return i},unsubscribe:function(){i=!0,ke.storagemutated.unsubscribe(_)}};t.start&&t.start(s);var f=!1,y=!1;function m(){return H(o).some(function(T){return u[T]&&ru(u[T],o[T])})}var _=function(T){ri(u,T),m()&&w()},w=function(){if(!(f||i)){u={};var T={},E=r(T);y||(ke(tt,_),y=!0),f=!0,Promise.resolve(E).then(function(k){f=!1,!i&&(m()?w():(u={},o=T,t.next&&t.next(k)))},function(k){f=!1,t.error&&t.error(k),s.unsubscribe()})}};return w(),s})}var Sn;try{Sn={indexedDB:$.indexedDB||$.mozIndexedDB||$.webkitIndexedDB||$.msIndexedDB,IDBKeyRange:$.IDBKeyRange||$.webkitIDBKeyRange}}catch{Sn={indexedDB:null,IDBKeyRange:null}}var Ae=ni;Ne(Ae,F(F({},jt),{delete:function(e){var t=new Ae(e,{addons:[]});return t.delete()},exists:function(e){return new Ae(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return Va(Ae.dependencies).then(e)}catch{return V(new B.MissingAPI)}},defineClass:function(){function e(t){Z(this,t)}return e},ignoreTransaction:function(e){return O.trans?Ue(O.transless,e):e()},vip:xn,async:function(e){return function(){try{var t=kn(e.apply(this,arguments));return!t||typeof t.then!="function"?I.resolve(t):t}catch(n){return V(n)}}},spawn:function(e,t,n){try{var r=kn(e.apply(n,t||[]));return!r||typeof r.then!="function"?I.resolve(r):r}catch(i){return V(i)}},currentTransaction:{get:function(){return O.trans||null}},waitFor:function(e,t){var n=I.resolve(typeof e=="function"?Ae.ignoreTransaction(e):e).timeout(t||6e4);return O.trans?O.trans.waitFor(n):n},Promise:I,debug:{get:function(){return se},set:function(e){Dr(e,e==="dexie"?function(){return!0}:Gr)}},derive:$e,extend:Z,props:Ne,override:Tr,Events:ht,on:ke,liveQuery:su,extendObservabilitySet:ri,getByKeyPath:ve,setByKeyPath:ue,delByKeyPath:$i,shallowClone:Kr,deepClone:st,getObjectDiff:Vn,cmp:J,asap:Cr,minKey:gn,addons:[],connections:Ye,errnames:On,dependencies:Sn,semVer:ur,version:ur.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,n*2)})}));Ae.maxKey=nt(Ae.dependencies.IDBKeyRange);typeof dispatchEvent!="undefined"&&typeof addEventListener!="undefined"&&(ke(tt,function(e){if(!de){var t;Ht?(t=document.createEvent("CustomEvent"),t.initCustomEvent(we,!0,!0,e)):t=new CustomEvent(we,{detail:e}),de=!0,dispatchEvent(t),de=!1}}),addEventListener(we,function(e){var t=e.detail;de||Ft(t)}));function Ft(e){var t=de;try{de=!0,ke.storagemutated.fire(e)}finally{de=t}}var de=!1;if(typeof BroadcastChannel!="undefined"){var pr=new BroadcastChannel(we);ke(tt,function(e){de||pr.postMessage(e)}),pr.onmessage=function(e){e.data&&Ft(e.data)}}else if(typeof self!="undefined"&&typeof navigator!="undefined"){ke(tt,function(e){try{de||(typeof localStorage!="undefined"&&localStorage.setItem(we,JSON.stringify({trig:Math.random(),changedParts:e})),typeof self.clients=="object"&&nn([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach(function(t){return t.postMessage({type:we,changedParts:e})}))}catch{}}),addEventListener("storage",function(e){if(e.key===we){var t=JSON.parse(e.newValue);t&&Ft(t.changedParts)}});var vr=self.document&&navigator.serviceWorker;vr&&vr.addEventListener("message",cu)}function cu(e){var t=e.data;t&&t.type===we&&Ft(t.changedParts)}I.rejectionMapper=qi;Dr(se,Gr);function lu(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach(function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})}),t}var fu={},ii={},hu={},du=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:hu}),pu=lu(du);(function(e){(function(t){var n=t.Markdown=function(v){switch(typeof v){case"undefined":this.dialect=n.dialects.Gruber;break;case"object":this.dialect=v;break;default:if(v in n.dialects)this.dialect=n.dialects[v];else throw new Error("Unknown Markdown dialect '"+String(v)+"'");break}this.em_state=[],this.strong_state=[],this.debug_indent=""};t.parse=function(v,c){var h=new n(c);return h.toTree(v)},t.toHTML=function(c,h,d){var l=t.toHTMLTree(c,h,d);return t.renderJsonML(l)},t.toHTMLTree=function(c,h,d){typeof c=="string"&&(c=this.parse(c,h));var l=w(c),g={};l&&l.references&&(g=l.references);var b=k(c,g,d);return S(b),b};function r(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function i(){var v=pu;return"Markdown.mk_block( "+v.inspect(this.toString())+", "+v.inspect(this.trailing)+", "+v.inspect(this.lineNumber)+" )"}var u=n.mk_block=function(v,c,h){arguments.length==1&&(c=`

`);var d=new String(v);return d.trailing=c,d.inspect=i,d.toSource=r,h!=null&&(d.lineNumber=h),d};function o(v){for(var c=0,h=-1;(h=v.indexOf(`
`,h+1))!==-1;)c++;return c}n.prototype.split_blocks=function(c,h){c=c.replace(/(\r\n|\n|\r)/g,`
`);var d=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,l=[],g,b=1;for((g=/^(\s*\n)/.exec(c))!=null&&(b+=o(g[0]),d.lastIndex=g[0].length);(g=d.exec(c))!==null;)g[2]==`
#`&&(g[2]=`
`,d.lastIndex--),l.push(u(g[1],g[2],b)),b+=o(g[0]);return l},n.prototype.processBlock=function(c,h){var d=this.dialect.block,l=d.__order__;if("__call__"in d)return d.__call__.call(this,c,h);for(var g=0;g<l.length;g++){var b=d[l[g]].call(this,c,h);if(b)return(!y(b)||b.length>0&&!y(b[0]))&&this.debug(l[g],"didn't return a proper array"),b}return[]},n.prototype.processInline=function(c){return this.dialect.inline.__call__.call(this,String(c))},n.prototype.toTree=function(c,h){var d=c instanceof Array?c:this.split_blocks(c),l=this.tree;try{this.tree=h||this.tree||["markdown"];e:for(;d.length;){var g=this.processBlock(d.shift(),d);if(!g.length)continue e;this.tree.push.apply(this.tree,g)}return this.tree}finally{h&&(this.tree=l)}},n.prototype.debug=function(){var v=Array.prototype.slice.call(arguments);v.unshift(this.debug_indent),typeof print!="undefined"&&print.apply(print,v),typeof console!="undefined"&&typeof console.log!="undefined"&&console.log.apply(null,v)},n.prototype.loop_re_over_block=function(v,c,h){for(var d,l=c.valueOf();l.length&&(d=v.exec(l))!=null;)l=l.substr(d[0].length),h.call(this,d);return l},n.dialects={},n.dialects.Gruber={block:{atxHeader:function(c,h){var d=c.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(!!d){var l=["header",{level:d[1].length}];return Array.prototype.push.apply(l,this.processInline(d[2])),d[0].length<c.length&&h.unshift(u(c.substr(d[0].length),c.trailing,c.lineNumber+2)),[l]}},setextHeader:function(c,h){var d=c.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(!!d){var l=d[2]==="="?1:2,g=["header",{level:l},d[1]];return d[0].length<c.length&&h.unshift(u(c.substr(d[0].length),c.trailing,c.lineNumber+2)),[g]}},code:function(c,h){var d=[],l=/^(?: {0,3}\t| {4})(.*)\n?/;if(!c.match(l))return;e:do{var g=this.loop_re_over_block(l,c.valueOf(),function(b){d.push(b[1])});if(g.length){h.unshift(u(g,c.trailing));break e}else if(h.length){if(!h[0].match(l))break e;d.push(c.trailing.replace(/[^\n]/g,"").substring(2)),c=h.shift()}else break e}while(!0);return[["code_block",d.join(`
`)]]},horizRule:function(c,h){var d=c.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(!!d){var l=[["hr"]];return d[1]&&l.unshift.apply(l,this.processBlock(d[1],[])),d[3]&&h.unshift(u(d[3])),l}},lists:function(){var v="[*+-]|\\d+\\.",c=/[*+-]/,h=new RegExp("^( {0,3})("+v+")[ 	]+"),d="(?: {0,3}\\t| {4})";function l(A){return new RegExp("(?:^("+d+"{0,"+A+"} {0,3})("+v+")\\s+)|(^"+d+"{0,"+(A-1)+"}[ ]{0,4})")}function g(A){return A.replace(/ {0,3}\t/g,"    ")}function b(A,K,R,M){if(K){A.push(["para"].concat(R));return}var D=A[A.length-1]instanceof Array&&A[A.length-1][0]=="para"?A[A.length-1]:A;M&&A.length>1&&R.unshift(M);for(var P=0;P<R.length;P++){var L=R[P],z=typeof L=="string";z&&D.length>1&&typeof D[D.length-1]=="string"?D[D.length-1]+=L:D.push(L)}}function x(A,K){for(var R=new RegExp("^("+d+"{"+A+"}.*?\\n?)*$"),M=new RegExp("^"+d+"{"+A+"}","gm"),D=[];K.length>0&&R.exec(K[0]);){var P=K.shift(),L=P.replace(M,"");D.push(u(L,P.trailing,P.lineNumber))}return D}function C(A,K,R){var M=A.list,D=M[M.length-1];if(!(D[1]instanceof Array&&D[1][0]=="para"))if(K+1==R.length)D.push(["para"].concat(D.splice(1,D.length-1)));else{var P=D.pop();D.push(["para"].concat(D.splice(1,D.length-1)),P)}}return function(A,K){var R=A.match(h);if(!R)return;function M(pt){var Qn=c.exec(pt[2])?["bulletlist"]:["numberlist"];return D.push({list:Qn,indent:pt[1]}),Qn}var D=[],P=M(R),L,z=!1,ne=[D[0].list],W;e:for(;;){for(var X=A.split(/(?=\n)/),G="",ee=0;ee<X.length;ee++){var ae="",Q=X[ee].replace(/^\n/,function(pt){return ae=pt,""}),De=l(D.length);if(R=Q.match(De),R[1]!==void 0){G.length&&(b(L,z,this.processInline(G),ae),z=!1,G=""),R[1]=g(R[1]);var me=Math.floor(R[1].length/4)+1;if(me>D.length)P=M(R),L.push(P),L=P[1]=["listitem"];else{var Gn=!1;for(W=0;W<D.length;W++)if(D[W].indent==R[1]){P=D[W].list,D.splice(W+1,D.length-(W+1)),Gn=!0;break}Gn||(me++,me<=D.length?(D.splice(me,D.length-me),P=D[me-1].list):(P=M(R),L.push(P))),L=["listitem"],P.push(L)}ae=""}Q.length>R[0].length&&(G+=ae+Q.substr(R[0].length))}G.length&&(b(L,z,this.processInline(G),ae),z=!1,G="");var Yn=x(D.length,K);Yn.length>0&&(m(D,C,this),L.push.apply(L,this.toTree(Yn,[])));var qn=K[0]&&K[0].valueOf()||"";if(qn.match(h)||qn.match(/^ /)){A=K.shift();var Xn=this.dialect.block.horizRule(A,K);if(Xn){ne.push.apply(ne,Xn);break}m(D,C,this),z=!0;continue e}break}return ne}}(),blockquote:function(c,h){if(!!c.match(/^>/m)){var d=[];if(c[0]!=">"){for(var l=c.split(/\n/),g=[],b=c.lineNumber;l.length&&l[0][0]!=">";)g.push(l.shift()),b++;var x=u(g.join(`
`),`
`,c.lineNumber);d.push.apply(d,this.processBlock(x,[])),c=u(l.join(`
`),c.trailing,b)}for(;h.length&&h[0][0]==">";){var C=h.shift();c=u(c+c.trailing+C,C.trailing,c.lineNumber)}var A=c.replace(/^> ?/gm,"");this.tree;var K=this.toTree(A,["blockquote"]),R=w(K);return R&&R.references&&(delete R.references,_(R)&&K.splice(1,1)),d.push(K),d}},referenceDefn:function(c,h){var d=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/;if(!!c.match(d)){w(this.tree)||this.tree.splice(1,0,{});var l=w(this.tree);l.references===void 0&&(l.references={});var g=this.loop_re_over_block(d,c,function(b){b[2]&&b[2][0]=="<"&&b[2][b[2].length-1]==">"&&(b[2]=b[2].substring(1,b[2].length-1));var x=l.references[b[1].toLowerCase()]={href:b[2]};b[4]!==void 0?x.title=b[4]:b[5]!==void 0&&(x.title=b[5])});return g.length&&h.unshift(u(g,c.trailing)),[]}},para:function(c,h){return[["para"].concat(this.processInline(c))]}}},n.dialects.Gruber.inline={__oneElement__:function(c,h,d){var l,b;h=h||this.dialect.inline.__patterns__;var g=new RegExp("([\\s\\S]*?)("+(h.source||h)+")");if(l=g.exec(c),l){if(l[1])return[l[1].length,l[1]]}else return[c.length,c];var b;return l[2]in this.dialect.inline&&(b=this.dialect.inline[l[2]].call(this,c.substr(l.index),l,d||[])),b=b||[l[2].length,l[2]],b},__call__:function(c,h){var d=[],l;function g(b){typeof b=="string"&&typeof d[d.length-1]=="string"?d[d.length-1]+=b:d.push(b)}for(;c.length>0;)l=this.dialect.inline.__oneElement__.call(this,c,h,d),c=c.substr(l.shift()),m(l,g);return d},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}\[\]()#\+.!\-]/,"\\":function(c){return this.dialect.inline.__escape__.exec(c)?[2,c.charAt(1)]:[1,"\\"]},"![":function(c){var h=c.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(h){h[2]&&h[2][0]=="<"&&h[2][h[2].length-1]==">"&&(h[2]=h[2].substring(1,h[2].length-1)),h[2]=this.dialect.inline.__call__.call(this,h[2],/\\/)[0];var d={alt:h[1],href:h[2]||""};return h[4]!==void 0&&(d.title=h[4]),[h[0].length,["img",d]]}return h=c.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),h?[h[0].length,["img_ref",{alt:h[1],ref:h[2].toLowerCase(),original:h[0]}]]:[2,"!["]},"[":function(c){var h=String(c),d=n.DialectHelpers.inline_until_char.call(this,c.substr(1),"]");if(!d)return[1,"["];var l=1+d[0],g=d[1],b,x;c=c.substr(l);var C=c.match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(C){var A=C[1];if(l+=C[0].length,A&&A[0]=="<"&&A[A.length-1]==">"&&(A=A.substring(1,A.length-1)),!C[3])for(var K=1,R=0;R<A.length;R++)switch(A[R]){case"(":K++;break;case")":--K==0&&(l-=A.length-R,A=A.substring(0,R));break}return A=this.dialect.inline.__call__.call(this,A,/\\/)[0],x={href:A||""},C[3]!==void 0&&(x.title=C[3]),b=["link",x].concat(g),[l,b]}return C=c.match(/^\s*\[(.*?)\]/),C?(l+=C[0].length,x={ref:(C[1]||String(g)).toLowerCase(),original:h.substr(0,l)},b=["link_ref",x].concat(g),[l,b]):g.length==1&&typeof g[0]=="string"?(x={ref:g[0].toLowerCase(),original:h.substr(0,l)},b=["link_ref",x,g[0]],[l,b]):[1,"["]},"<":function(c){var h;return(h=c.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))!=null?h[3]?[h[0].length,["link",{href:"mailto:"+h[3]},h[3]]]:h[2]=="mailto"?[h[0].length,["link",{href:h[1]},h[1].substr(7)]]:[h[0].length,["link",{href:h[1]},h[1]]]:[1,"<"]},"`":function(c){var h=c.match(/(`+)(([\s\S]*?)\1)/);return h&&h[2]?[h[1].length+h[2].length,["inlinecode",h[3]]]:[1,"`"]},"  \n":function(c){return[3,["linebreak"]]}};function s(v,c){var h=v+"_state",d=v=="strong"?"em_state":"strong_state";function l(g){this.len_after=g,this.name="close_"+c}return function(g,b){if(this[h][0]==c)return this[h].shift(),[g.length,new l(g.length-c.length)];var x=this[d].slice(),C=this[h].slice();this[h].unshift(c);var A=this.processInline(g.substr(c.length)),K=A[A.length-1];if(this[h].shift(),K instanceof l){A.pop();var R=g.length-K.len_after;return[R,[v].concat(A)]}else return this[d]=x,this[h]=C,[c.length,c]}}n.dialects.Gruber.inline["**"]=s("strong","**"),n.dialects.Gruber.inline.__=s("strong","__"),n.dialects.Gruber.inline["*"]=s("em","*"),n.dialects.Gruber.inline._=s("em","_"),n.buildBlockOrder=function(v){var c=[];for(var h in v)h=="__order__"||h=="__call__"||c.push(h);v.__order__=c},n.buildInlinePatterns=function(v){var c=[];for(var h in v)if(!h.match(/^__.*__$/)){var d=h.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");c.push(h.length==1?d:"(?:"+d+")")}c=c.join("|"),v.__patterns__=c;var l=v.__call__;v.__call__=function(g,b){return b!=null?l.call(this,g,b):l.call(this,g,c)}},n.DialectHelpers={},n.DialectHelpers.inline_until_char=function(v,c){for(var h=0,d=[];;){if(v.charAt(h)==c)return h++,[h,d];if(h>=v.length)return null;var l=this.dialect.inline.__oneElement__.call(this,v.substr(h));h+=l[0],d.push.apply(d,l.slice(1))}},n.subclassDialect=function(v){function c(){}c.prototype=v.block;function h(){}return h.prototype=v.inline,{block:new c,inline:new h}},n.buildBlockOrder(n.dialects.Gruber.block),n.buildInlinePatterns(n.dialects.Gruber.inline),n.dialects.Maruku=n.subclassDialect(n.dialects.Gruber),n.dialects.Maruku.processMetaHash=function(c){for(var h=f(c),d={},l=0;l<h.length;++l)if(/^#/.test(h[l]))d.id=h[l].substring(1);else if(/^\./.test(h[l]))d.class?d.class=d.class+h[l].replace(/./," "):d.class=h[l].substring(1);else if(/\=/.test(h[l])){var g=h[l].split(/\=/);d[g[0]]=g[1]}return d};function f(v){for(var c=v.split(""),h=[""],d=!1;c.length;){var l=c.shift();switch(l){case" ":d?h[h.length-1]+=l:h.push("");break;case"'":case'"':d=!d;break;case"\\":l=c.shift();default:h[h.length-1]+=l;break}}return h}n.dialects.Maruku.block.document_meta=function(c,h){if(!(c.lineNumber>1)&&!!c.match(/^(?:\w+:.*\n)*\w+:.*$/)){w(this.tree)||this.tree.splice(1,0,{});var d=c.split(/\n/);for(p in d){var l=d[p].match(/(\w+):\s*(.*)$/),g=l[1].toLowerCase(),b=l[2];this.tree[1][g]=b}return[]}},n.dialects.Maruku.block.block_meta=function(c,h){var d=c.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(!!d){var l=this.dialect.processMetaHash(d[2]),g;if(d[1]===""){var b=this.tree[this.tree.length-1];if(g=w(b),typeof b=="string")return;g||(g={},b.splice(1,0,g));for(a in l)g[a]=l[a];return[]}var x=c.replace(/\n.*$/,""),C=this.processBlock(x,[]);g=w(C[0]),g||(g={},C[0].splice(1,0,g));for(a in l)g[a]=l[a];return C}},n.dialects.Maruku.block.definition_list=function(c,h){var d=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,l=["dl"],g,b;if(b=c.match(d)){for(var x=[c];h.length&&d.exec(h[0]);)x.push(h.shift());for(var C=0;C<x.length;++C){var b=x[C].match(d),A=b[1].replace(/\n$/,"").split(/\n/),K=b[2].split(/\n:\s+/);for(g=0;g<A.length;++g)l.push(["dt",A[g]]);for(g=0;g<K.length;++g)l.push(["dd"].concat(this.processInline(K[g].replace(/(\n)\s+/,"$1"))))}}else return;return[l]},n.dialects.Maruku.block.table=function(c,h){var d=function(K,R){R=R||"\\s",R.match(/^[\\|\[\]{}?*.+^$]$/)&&(R="\\"+R);for(var M=[],D=new RegExp("^((?:\\\\.|[^\\\\"+R+"])*)"+R+"(.*)"),P;P=K.match(D);)M.push(P[1]),K=P[2];return M.push(K),M},l=/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/,g=/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/,b,x;if(x=c.match(l))x[3]=x[3].replace(/^\s*\|/gm,"");else if(!(x=c.match(g)))return;var C=["table",["thead",["tr"]],["tbody"]];x[2]=x[2].replace(/\|\s*$/,"").split("|");var A=[];for(m(x[2],function(K){K.match(/^\s*-+:\s*$/)?A.push({align:"right"}):K.match(/^\s*:-+\s*$/)?A.push({align:"left"}):K.match(/^\s*:-+:\s*$/)?A.push({align:"center"}):A.push({})}),x[1]=d(x[1].replace(/\|\s*$/,""),"|"),b=0;b<x[1].length;b++)C[1][1].push(["th",A[b]||{}].concat(this.processInline(x[1][b].trim())));return m(x[3].replace(/\|\s*$/mg,"").split(`
`),function(K){var R=["tr"];for(K=d(K,"|"),b=0;b<K.length;b++)R.push(["td",A[b]||{}].concat(this.processInline(K[b].trim())));C[2].push(R)},this),[C]},n.dialects.Maruku.inline["{:"]=function(c,h,d){if(!d.length)return[2,"{:"];var l=d[d.length-1];if(typeof l=="string")return[2,"{:"];var g=c.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!g)return[2,"{:"];var b=this.dialect.processMetaHash(g[1]),x=w(l);x||(x={},l.splice(1,0,x));for(var C in b)x[C]=b[C];return[g[0].length,""]},n.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,n.buildBlockOrder(n.dialects.Maruku.block),n.buildInlinePatterns(n.dialects.Maruku.inline);var y=Array.isArray||function(v){return Object.prototype.toString.call(v)=="[object Array]"},m;Array.prototype.forEach?m=function(v,c,h){return v.forEach(c,h)}:m=function(v,c,h){for(var d=0;d<v.length;d++)c.call(h||v,v[d],d,v)};var _=function(v){for(var c in v)if(hasOwnProperty.call(v,c))return!1;return!0};function w(v){return y(v)&&v.length>1&&typeof v[1]=="object"&&!y(v[1])?v[1]:void 0}t.renderJsonML=function(v,c){c=c||{},c.root=c.root||!1;var h=[];if(c.root)h.push(E(v));else for(v.shift(),v.length&&typeof v[0]=="object"&&!(v[0]instanceof Array)&&v.shift();v.length;)h.push(E(v.shift()));return h.join(`

`)};function T(v){return v.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function E(v){if(typeof v=="string")return T(v);var c=v.shift(),h={},d=[];for(v.length&&typeof v[0]=="object"&&!(v[0]instanceof Array)&&(h=v.shift());v.length;)d.push(E(v.shift()));var l="";for(var g in h)l+=" "+g+'="'+T(h[g])+'"';return c=="img"||c=="br"||c=="hr"?"<"+c+l+"/>":"<"+c+l+">"+d.join("")+"</"+c+">"}function k(v,c,h){var d;h=h||{};var l=v.slice(0);typeof h.preprocessTreeNode=="function"&&(l=h.preprocessTreeNode(l,c));var g=w(l);if(g){l[1]={};for(d in g)l[1][d]=g[d];g=l[1]}if(typeof l=="string")return l;switch(l[0]){case"header":l[0]="h"+l[1].level,delete l[1].level;break;case"bulletlist":l[0]="ul";break;case"numberlist":l[0]="ol";break;case"listitem":l[0]="li";break;case"para":l[0]="p";break;case"markdown":l[0]="html",g&&delete g.references;break;case"code_block":l[0]="pre",d=g?2:1;var b=["code"];b.push.apply(b,l.splice(d,l.length-d)),l[d]=b;break;case"inlinecode":l[0]="code";break;case"img":l[1].src=l[1].href,delete l[1].href;break;case"linebreak":l[0]="br";break;case"link":l[0]="a";break;case"link_ref":l[0]="a";var x=c[g.ref];if(x)delete g.ref,g.href=x.href,x.title&&(g.title=x.title),delete g.original;else return g.original;break;case"img_ref":l[0]="img";var x=c[g.ref];if(x)delete g.ref,g.src=x.href,x.title&&(g.title=x.title),delete g.original;else return g.original;break}if(d=1,g){for(var C in l[1]){d=2;break}d===1&&l.splice(d,1)}for(;d<l.length;++d)l[d]=k(l[d],c,h);return l}function S(v){for(var c=w(v)?2:1;c<v.length;)typeof v[c]=="string"?c+1<v.length&&typeof v[c+1]=="string"?v[c]+=v.splice(c+1,1)[0]:++c:(S(v[c]),++c)}})(function(){return e}())})(ii);(function(e){e.markdown=ii,e.parse=e.markdown.toHTML})(fu);export{fu as A,Eu as B,Au as C,ni as D,vi as E,yi as F,Tu as G,Oi as H,Mu as S,ku as a,Cu as b,wu as c,bu as d,xu as e,ci as f,yu as g,_u as h,Bu as i,gu as j,br as k,gi as l,Pu as m,yr as n,Ou as o,mi as p,Su as q,Du as r,vu as s,_r as t,mu as u,_i as v,Iu as w,Ku as x,it as y,Ru as z};
